<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Asthros Colors ‚Äì Cosmic Edition</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;500;700;900&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
    <style>
        /* Define a fonte e o fundo principal */
        body { 
            font-family: 'Inter', sans-serif; 
            margin:0; 
            background: #000; /* Fundo preto para o tema c√≥smico */
            color: white; 
            overflow-x: hidden; 
        }

        /* Camada de fundo est√°tica: um gradiente radial suave */
        .vortex-bg { 
            position: fixed; 
            inset: 0; 
            z-index: -2; 
            background: radial-gradient(circle at center, #0a0a1a 0%, #000 100%); 
        }

        /* Camada de Aurora (Gradiente Animado e Din√¢mico) */
        .aurora { 
            position: fixed; 
            inset: 0; 
            z-index: -1; 
            /* Gradiente inicial (ser√° mudado dinamicamente para as cores da paleta) */
            background: linear-gradient(45deg, #ff00cc, #3333ff, #00ffcc, #ffff00); 
            background-size: 400% 400%; 
            animation: aurora-pan 30s ease infinite; 
            opacity: 0.25; /* Suave, para n√£o competir com o conte√∫do */
            mix-blend-mode: screen; 
            transition: background 5s cubic-bezier(0.4, 0, 0.2, 1); /* Transi√ß√£o suave de 5s */
        }

        /* Keyframes para anima√ß√£o do background-position (efeito de movimento) */
        @keyframes aurora-pan {
            0% { background-position: 0% 50% }
            50% { background-position: 100% 50% }
            100% { background-position: 0% 50% }
        }

        /* Estilos do Container e Card de Pergunta/Resposta (Manuten√ß√£o do Shatter/Assemble) */
       .card-container { 
    position: relative; 
    width: 100%; 
    perspective: 1200px; /* Aumenta a profundidade 3D para o efeito */
    
    /* Mantenha o min-height alto, ou aumente para algo como 700px */
    min-height: 700px; /* AUMENTE AQUI */ 
    
    display: flex;
    justify-content: center;
    align-items: flex-start;
    
    /* === AJUSTES DE EMPILHAMENTO E POSI√á√ÉO === */
    padding-top: 3rem;
    /* Remova o padding-bottom fixo para evitar vazamentos e use o min-height */
    z-index: 50;
    /* ========================================= */
}
        .card { 
    position: absolute; /* Usar absolute para o efeito de transi√ß√£o */
    width: 100%;
    max-width: 600px; /* Limite a largura para foco */
    
    /* === AJUSTES DE POSI√á√ÉO E EMPILHAMENTO === */
    top: 0;           /* Ancorar no topo do card-container (que j√° tem o padding de separa√ß√£o) */
    z-index: 20;      /* Coloca o card abaixo do footer (z-30) */
    /* ========================================= */
    
    background: rgba(15, 15, 30, 0.95); 
    backdrop-filter: blur(20px); 
    border: 1px solid rgba(150, 100, 255, 0.4); 
    border-radius: 2.5rem; /* Mais arredondado */
    padding: 3.5rem; 
    box-shadow: 0 40px 100px rgba(0, 0, 0, 0.9); 
}
        .piece { 
            position: absolute; 
            background: rgba(30, 30, 60, 0.98); 
            border-radius: 12px; 
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.7); 
            backdrop-filter: blur(10px); 
        }
        
        /* Efeito de Ripple */
        .ripple-btn { 
            position: relative; 
            overflow: hidden; 
            cursor: pointer; 
            transition: transform 0.3s, box-shadow 0.3s;
        }
        .ripple { 
            position: absolute; 
            border-radius: 50%; 
            background: rgba(255, 255, 255, 0.7); 
            transform: scale(0); 
            animation: r 0.6s linear; 
            pointer-events: none; 
        }
        @keyframes r {
            to { transform: scale(4); opacity: 0 }
        }
        /* Efeito de Estrelas */
        .star { 
            position: absolute; 
            background: white; 
            border-radius: 50%; 
            pointer-events: none; 
            animation: star-twinkle 4s infinite; 
            box-shadow: 0 0 5px rgba(255, 255, 255, 0.8);
        }
        @keyframes star-twinkle {
            0%, 100% { opacity: 0.3 }
            50% { opacity: 1 }
        }

        /* Ajustes de Layout e Transi√ß√£o */
      .main-container {
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    
    /* === AJUSTE DE ESPA√áAMENTO === */
    padding-bottom: 20rem; /* Aumenta a margem de respiro no final da p√°gina */
    /* ============================ */
    
    padding-top: 4rem;
    
    position: relative;
    z-index: 10;
}
        #quiz, #result {
            width: 100%;
            max-width: 72rem;
            margin: 0 auto;
            padding: 0 1.5rem;
        }
        #result {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            opacity: 0;
            visibility: hidden;
        }
        #result.visible {
            position: relative;
            opacity: 1;
            visibility: visible;
            z-index: 20;
            transition: opacity 1.5s ease 0.5s; /* Transi√ß√£o longa para o resultado */
        }
        .main-container.result-active {
            min-height: unset;
            justify-content: flex-start;
            padding-top: 6rem;
        }

        /* Estilo da caixa de cor na paleta */
        .color-box-shadow {
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5), inset 0 0 15px rgba(255, 255, 255, 0.1);
        }
    </style>
</head>
<body>
    <div class="vortex-bg"></div>
    <div class="aurora" id="aurora"></div>

    <div class="relative z-10 main-container" id="mainContainer">
        
        <div id="quiz" class="text-center">
            <div class="flex items-end justify-center mb-6">
                <h1 class="text-6xl md:text-8xl font-extrabold tracking-tight bg-clip-text text-transparent bg-gradient-to-r from-sky-400 via-fuchsia-500 to-indigo-600">
                    Asthro Colors
                </h1>
                <span class="text-xl md:text-3xl font-extrabold bg-clip-text text-transparent bg-gradient-to-r from-sky-400 via-fuchsia-500 to-indigo-600 ml-3 pb-2">
                    ‚ú® Cosmic Edition
                </span>
            </div>
            <p class="text-2xl text-gray-400 mb-16">Responda e veja o universo montar sua paleta exclusiva.</p>
            
            <div id="card-wrapper" class="card-container mx-auto"></div>
            
            <div class="flex justify-center gap-6 mt-16 flex-wrap">
                <button id="backBtn" class="px-8 py-4 text-xl font-bold rounded-full bg-gray-800/80 hover:bg-gray-700 border border-gray-700 ripple-btn text-gray-300 transition hidden">
                    <svg class="w-5 h-5 inline-block mr-2 -mt-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg>
                    Voltar
                </button>
                <button id="generateBtn" class="hidden px-16 py-7 text-3xl font-extrabold rounded-full bg-gradient-to-r from-cyan-500 to-purple-600 hover:scale-[1.02] active:scale-100 shadow-2xl shadow-purple-900/50 transition duration-300 ripple-btn">
                    GERAR PALETA C√ìSMICA
                    <svg class="w-7 h-7 inline-block ml-3 -mt-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.054 2.054a10.875 10.875 0 010 15.892L14 21m-5-5h.01M17 11h.01M17 14h.01M12 11h.01M12 14h.01"></path></svg>
                </button>
            </div>
        </div>

        <div id="result" class="text-center pb-20">
            <h2 class="text-7xl font-extrabold mb-16 bg-clip-text text-transparent bg-gradient-to-r from-cyan-400 via-purple-400 to-pink-400">
                üöÄ Sua Paleta C√≥smica Est√° Pronta
            </h2>
            
            <div id="palette" class="grid grid-cols-2 md:grid-cols-5 gap-6 max-w-7xl mx-auto mb-20">
                </div>
            
            <div class="grid md:grid-cols-2 gap-12 max-w-6xl mx-auto">
                <div class="bg-gray-900/60 p-12 rounded-4xl backdrop-blur-xl border border-purple-500/30 text-left shadow-2xl">
                    <h3 class="text-4xl font-extrabold mb-8 text-purple-400 flex items-center">
                        <svg class="w-8 h-8 mr-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19V6l12-3v14m-12 3h12a2 2 0 002-2v-4m-12 0h12m-6 4v-4m-6-10H5a2 2 0 00-2 2v10a2 2 0 002 2h2m-2 0l7-7m-7 7l7-7"></path></svg>
                        An√°lise C√≥smica
                    </h3>
                    <div id="analysis" class="text-xl text-gray-300 leading-relaxed space-y-4"></div>
                </div>
                
                <div class="bg-gray-900/60 p-12 rounded-4xl backdrop-blur-xl border border-pink-500/30 text-left shadow-2xl">
                    <h3 class="text-4xl font-extrabold mb-8 text-pink-400 flex items-center">
                        <svg class="w-8 h-8 mr-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 11l5-5m0 0l5 5m-5-5v12"></path></svg>
                        C√≥digos HEX
                    </h3>
                    <div id="hexList" class="space-y-6 font-mono text-xl"></div>
                    <button onclick="copyAll()" class="mt-10 w-full py-5 bg-gradient-to-r from-emerald-500 to-cyan-500 rounded-2xl font-bold text-2xl hover:scale-[1.01] transition shadow-lg shadow-cyan-800/40 ripple-btn">
                        Copiar Todos os C√≥digos
                    </button>
                </div>
            </div>

            <button onclick="location.reload()" class="mt-20 px-12 py-5 text-2xl rounded-full bg-gray-800/80 hover:bg-gray-700 border border-gray-700 transition font-bold ripple-btn">
                Nova Paleta
            </button>
        </div>
    </div>

    <footer class="relative w-full text-center py-6 mt-auto bg-gradient-to-t from-black/90 to-transparent text-gray-500 text-sm **z-60**">
¬† ¬† ¬© 2025 Asthro ‚Ä¢ Todos os direitos reservados
</footer>

    <div id="loading" class="hidden fixed inset-0 flex items-center justify-center bg-black/95 z-50 transition duration-500">
        <div class="text-center">
            <div class="w-48 h-48 border-8 border-t-purple-500 border-r-pink-500 border-b-cyan-500 border-l-transparent rounded-full animate-spin mb-10 mx-auto"></div>
            <p class="text-4xl font-black bg-clip-text text-transparent bg-gradient-to-r from-purple-400 to-pink-400">Montando sua paleta no cosmos‚Ä¶</p>
        </div>
    </div>

<script>
// ====================================================================
// TODO: O BLOCO DE DADOS (closingStatements, colorMeanings, questions)
// FOI OMITIDO AQUI POR SER GRANDE, MAS DEVE SER MANTIDO NO C√ìDIGO FINAL
// PARA GARANTIR 100% DA FUNCIONALIDADE.
// ... (c√≥digo JavaScript original com os dados)
// ====================================================================

const closingStatements = {
    'Poder': ['Esta paleta est√° pronta para dominar o mercado e transmitir autoridade m√°xima.', 'Uma funda√ß√£o crom√°tica de poder contido e eleg√¢ncia absoluta.', 'Sua marca projeta sofistica√ß√£o e controle com estas cores.'],
    'Autoridade': ['Uma funda√ß√£o s√≥lida para a sua marca, focada na confian√ßa e estabilidade.', 'Transmita autoridade e seriedade com esta sele√ß√£o crom√°tica.', 'Seu branding agora tem a credibilidade das maiores corpora√ß√µes.'],
    'Pureza': ['Sua marca agora respira tranquilidade e sofistica√ß√£o suave.', 'Harmonia e serenidade definidas em cores.', 'Perfeita para criar um ambiente de bem-estar e calmaria.'],
    'Minimalismo': ['Eleg√¢ncia e foco definem este conjunto crom√°tico.', 'Um visual clean e moderno, pronto para o minimalismo de alto n√≠vel.', 'A clareza √© o foco desta funda√ß√£o de branding.'],
    'Alegria': ['Uma explos√£o de vitalidade, pronta para o mercado!', 'Com esta paleta, sua marca irradia entusiasmo e criatividade.', 'Energia pura para impulsionar sua comunica√ß√£o visual.'],
    'Criatividade': ['O universo da inova√ß√£o est√° ao seu alcance com esta paleta √∫nica.', 'Um conjunto de cores que inspira originalidade e novas ideias.', 'Ideal para marcas que querem fugir do comum e abra√ßar a inventividade.'],
    'Paix√£o': ['Uma paleta vibrante que captura a for√ßa e o desejo.', 'Pronto para contagiar o p√∫blico com o seu entusiasmo?', 'A escolha certa para marcas din√¢micas e cheias de vida.'],
    'Realeza': ['Eleg√¢ncia e luxo em cada tonalidade.', 'Esta √© a paleta da exclusividade e do alto padr√£o.', 'Um visual premium garantido, sofisticado e atemporal.'],
    'Serenidade': ['A tradu√ß√£o perfeita de calma e inspira√ß√£o em cores.', 'Uma funda√ß√£o suave e profissional para o seu branding.', 'Tranquilidade visual para criar conex√µes duradouras.'],
    'Bem-estar': ['A paleta ideal para sa√∫de, frescor e equil√≠brio.', 'Seu universo de branding est√° completo e pronto para decolar.', 'Cores que convidam ao conforto e √† renova√ß√£o.'],
    'Estabilidade': ['Uma paleta robusta, que simboliza crescimento e seguran√ßa.', 'A funda√ß√£o ideal para um crescimento s√≥lido e confi√°vel.', 'Transmita a solidez da natureza em sua comunica√ß√£o.'],
    'Aconchego': ['Cores quentes que abra√ßam e convidam.', 'Um branding que fala de conforto, tradi√ß√£o e qualidade.', 'Calor visual para criar uma experi√™ncia acolhedora.'],
    'Tecnologia': ['A inova√ß√£o e o futurismo est√£o no seu DNA.', 'Uma paleta pensada para o mundo digital e high-tech.', 'Exclusividade e vanguarda em cada tonalidade.'],
    'Delicadeza': ['Suavidade e afeto definidos em cores leves.', 'O toque de ternura que sua marca precisava.', 'Beleza e calma para um visual rom√¢ntico e moderno.'],
    'Ousadia': ['Paleta de alto impacto, pronta para se destacar.', 'Sua marca com um visual forte, vibrante e inesquec√≠vel.', 'O √°pice da energia e da diferencia√ß√£o.'],
    'Mist√©rio': ['Intriga e sofistica√ß√£o em um √∫nico conjunto de cores.', 'Um branding que convida √† descoberta e √† profundidade.', 'Eleg√¢ncia e mist√©rio para um visual memor√°vel.'],
    'Destaque': ['A paleta perfeita para chamar a aten√ß√£o imediatamente.', 'Cores que garantem a√ß√£o e impacto no mercado.', 'Vibrante e inconfund√≠vel, sua marca n√£o passar√° despercebida.'],
    'Equil√≠brio': ['Esta paleta encontra o ponto ideal de harmonia entre todas as suas escolhas.','Sua marca projeta coer√™ncia e adaptabilidade.', 'Uma funda√ß√£o vers√°til, pronta para qualquer desafio.'],
    'Default': ['Sua funda√ß√£o de branding est√° completa e pronta para decolar!', 'O universo das cores conspirou a seu favor!', 'A combina√ß√£o final para o seu sucesso c√≥smico.']
};

const colorMeanings = {
    primary: {
        'Amarelo': { meaning: "Otimismo, alegria, energia, juventude, aten√ß√£o. Ideal para marcas que buscam clareza e positividade.", intent: "Alegria" },
        'Amarelo-lim√£o': { meaning: "Frescor, limpeza, energia c√≠trica, juventude. Perfeito para produtos de higiene ou bebidas energ√©ticas.", intent: "Frescor" },
        'Mostarda': { meaning: "Retr√¥ anos 70, ousadia temperada, outono, personalidade. Distinto e maduro.", intent: "Personalidade" },
        'Amarelo-ouro': { meaning: "Riqueza, prest√≠gio, sol, vit√≥ria, luxo acess√≠vel. Transmite alta qualidade e sucesso.", intent: "Riqueza" },
        'Laranja': { meaning: "Energia, criatividade, entusiasmo, acessibilidade, divers√£o. √ìtimo para comunica√ß√£o e marcas ativas.", intent: "Criatividade" },
        'Ab√≥bora': { meaning: "Outono, energia acolhedora, criatividade, rusticidade. Conforto e inspira√ß√£o.", intent: "Aconchego" },
        'Ferrugem': { meaning: "Vintage, industrial, envelhecido, outono, autenticidade. Para marcas com hist√≥ria ou toque r√∫stico chique.", intent: "Autenticidade" },
        'Coral': { meaning: "Vitalidade, tropical, feminilidade suave, energia positiva. Moderno e caloroso.", intent: "Vitalidade" },
        'Vermelho': { meaning: "Paix√£o, energia, urg√™ncia, poder, aten√ß√£o. Ideal para gerar a√ß√£o e impacto imediato.", intent: "Paix√£o" },
        'Bord√¥': { meaning: "Luxo, poder, maturidade, vinho, tradi√ß√£o, seriedade. Sofistica√ß√£o madura e elegante.", intent: "Maturidade" },
        'Escarlate': { meaning: "Paix√£o intensa, destaque, drama, coragem. Excelente para branding ousado.", intent: "Destaque" },
        'Rosa': { meaning: "Feminilidade, romantismo, delicadeza, juventude. Suavidade e afeto.", intent: "Delicadeza" },
        'Rosa-beb√™': { meaning: "Delicadeza, inf√¢ncia, ternura, romantismo suave. Calma e inoc√™ncia.", intent: "Ternura" },
        'F√∫csia': { meaning: "Ousadia, feminilidade forte, energia, modernidade. Para marcas que querem se destacar no mercado pop.", intent: "Ousadia" },
        'Lil√°s': { meaning: "Nostalgia, delicadeza, espiritualidade, suavidade. Romantismo vintage.", intent: "Suavidade" },
        'Roxo': { meaning: "Criatividade, originalidade, magia, luxo acess√≠vel. Sugere inova√ß√£o e fantasia.", intent: "Criatividade" },
        'P√∫rpura': { meaning: "Realeza hist√≥rica, espiritualidade, luxo, ambi√ß√£o. Autoridade e sofistica√ß√£o premium.", intent: "Realeza" },
        'Ametista': { meaning: "Luxo, espiritualidade, realeza, mist√©rio, criatividade. Conex√£o e valor.", intent: "Mist√©rio" },
        'Azul': { meaning: "Confian√ßa, profissionalismo, calma, credibilidade, tecnologia. A cor mais usada para estabilidade.", intent: "Confian√ßa" },
        'Azul-marinho': { meaning: "Autoridade, tradi√ß√£o, uniforme, credibilidade m√°xima. Para corpora√ß√µes e luxo tradicional.", intent: "Autoridade" },
        'Azul-celeste': { meaning: "Pureza, c√©u aberto, leveza, espiritualidade, serenidade. Calma e inspira√ß√£o.", intent: "Serenidade" },
        'Turquesa': { meaning: "Para√≠so tropical, frescor aqu√°tico, joalheria. Evoca bem-estar e luxo descontra√≠do.", intent: "Para√≠so" },
        'Verde': { meaning: "Natureza, crescimento, sa√∫de, equil√≠brio, dinheiro. S√≠mbolo de renova√ß√£o e estabilidade.", intent: "Crescimento" },
        'Verde-floresta': { meaning: "Natureza profunda, luxo ecol√≥gico, estabilidade. Para marcas org√¢nicas premium ou tradicionais.", intent: "Estabilidade" },
        'Verde-menta': { meaning: "Frescor, spa, sorvete, juventude, higiene. Ligado √† limpeza e bem-estar.", intent: "Bem-estar" },
        'Esmeralda': { meaning: "Luxo, natureza preciosa, esperan√ßa, sofistica√ß√£o. Valor e exclusividade.", intent: "Exclusividade" },
        'Oliva': { meaning: "Militar, paz, natureza mediterr√¢nea, praticidade. Sofistica√ß√£o discreta.", intent: "Praticidade" },
        'Marrom': { meaning: "Confiabilidade, terra, durabilidade, natureza, rusticidade. Transmite solidez e aconchego.", intent: "Confiabilidade" },
        'Caramelo': { meaning: "Do√ßura, conforto, aconchego, couro, outono. Luxo suave e t√°til.", intent: "Aconchego" },
        'Bege': { meaning: "Neutralidade, eleg√¢ncia discreta, sobriedade, cl√°ssico. Funda√ß√£o calma e sofisticada.", intent: "Eleg√¢ncia" },
        'Preto': { meaning: "Eleg√¢ncia absoluta, poder, mist√©rio, sofistica√ß√£o (moda), autoridade. O √°pice do luxo e seriedade.", intent: "Poder" },
        'Branco': { meaning: "Pureza, minimalismo, limpeza, modernidade, simplicidade. Clareza total e foco.", intent: "Pureza" },
        'Cinza-escuro': { meaning: "Poder contido, eleg√¢ncia urbana, profissionalismo s√©rio, tecnologia premium. Sofistica√ß√£o urbana.", intent: "Seriedade" },
        'Cinza-claro': { meaning: "Minimalismo moderno, limpeza, sofistica√ß√£o discreta, neutralidade elegante. Base vers√°til.", intent: "Minimalismo" },
        'Dourado': { meaning: "Luxo, sucesso, riqueza, premia√ß√£o, celebridade. Para excel√™ncia e prest√≠gio.", intent: "Prest√≠gio" },
        'Prata': { meaning: "Modernidade, tecnologia, segunda posi√ß√£o, sofistica√ß√£o fria. Inova√ß√£o e exclusividade tech.", intent: "Tecnologia" },
        'Bronze': { meaning: "Medalha, conquista, calor met√°lico. Conforto e tradi√ß√£o com um toque de gl√≥ria.", intent: "Conquista" },
        'Cobre': { meaning: "Tend√™ncia met√°lica, industrial chic, calor, artesanato. Autenticidade e modernidade.", intent: "Artesanato" },
    },
    combo: {
        'alimentos': [
            { name: 'Caf√© Brasileiro', style: 'suave', emotion: 'conforto', meaning: 'Caf√©s, padarias, conforto matinal (Cappuccino + Chocolate + Caramelo).' },
            { name: 'Outono Brasileiro', style: 'org√¢nico', emotion: 'aconchego', meaning: 'Festa junina, energia brasileira, alimentos quentinhos, acolhimento (Ab√≥bora + Mostarda + Caramelo).' },
            { name: 'Doceria Gourmet', style: 'suave', emotion: 'entusiasmo', meaning: 'Brigadeiro gourmet, p√¢tisserie, Instagram doce (Rosa Antigo + Chocolate).' },
            { name: 'Sorveteria', style: 'suave', emotion: 'entusiasmo', meaning: 'Do√ßura, inf√¢ncia, gelaterias, produtos gostosos (Menta + Lim√£o + Lavanda).' },
            { name: 'Cerveja Artesanal', style: 'vintage', emotion: 'confian√ßa', meaning: 'Naturalidade, l√∫pulo, r√≥tulos craft brasileiros.' },
            { name: 'Vinhos Naturais', style: 'org√¢nico', emotion: 'calma', meaning: 'Vin√≠colas boutique, vinho laranja, slow living.' },
            { name: 'Churrascaria', style: 'impactante', emotion: 'energia', meaning: 'Carne, Brasil, fome.' }
        ],
        'luxo': [
            { name: 'Quiet Luxury', style: 'minimalista', emotion: 'sofistica√ß√£o', meaning: 'Luxo sem logo, eleg√¢ncia sutil e alt√≠ssima qualidade (Loro Piana).' },
            { name: 'Vinho & Uva', style: 'vintage', emotion: 'sofistica√ß√£o', meaning: 'Sofistica√ß√£o adulta, vin√≠colas, restaurantes finos, moda noite.' },
            { name: 'J√≥ias Preciosas', style: 'vintage', emotion: 'confian√ßa', meaning: 'Luxo cl√°ssico, joalherias, perfumes caros.' },
            { name: 'Embalagem de Caf√© Premium', style: 'minimalista', emotion: 'confian√ßa', meaning: 'Caf√© especial, 90+ pontos, embalagem de luxo.' },
            { name: 'Barbearia Premium', style: 'vintage', emotion: 'confian√ßa', meaning: 'Masculinidade cl√°ssica, barbearias de luxo, whisky, couro.' },
            { name: 'Casamento Cl√°ssico', style: 'suave', emotion: 'calma', meaning: 'Casamento tradicional de igreja, buffet caro.' }
        ],
        'tecnologia': [
            { name: 'Tecnologia & Futurismo', style: 'impactante', emotion: 'energia', meaning: 'Cyberpunk, gaming, tecnologia de ponta (Azul El√©trico + Ciano + Magenta).' },
            { name: 'Executivo Moderno', style: 'moderno', emotion: 'confian√ßa', meaning: 'Terninhos, escrit√≥rios de advocacia, tecnologia s√©ria (Azul Marinho + Cinza).' },
            { name: 'Minimal Luxo', style: 'minimalista', emotion: 'sofistica√ß√£o', meaning: 'Arquitetura de alto padr√£o, moda minimalista, Apple Store.' },
            { name: 'Y2K Futurist', style: 'impactante', emotion: 'entusiasmo', meaning: 'Anos 2000 revival, Bratz, metallics.' },
            { name: 'Foco Monocrom√°tico (Tech)', style: 'minimalista', emotion: 'confian√ßa', meaning: "Aposta na simplicidade e eleg√¢ncia, muito usada por grandes empresas de software e eletr√¥nicos." }
        ],
        'saude': [
            { name: 'Yoga & Medita√ß√£o', style: 'org√¢nico', emotion: 'calma', meaning: 'Paz interior, est√∫dios de yoga, mindfulness (Lavanda + S√°lvia + Areia).' },
            { name: 'Skincare Coreana', style: 'minimalista', emotion: 'pureza', meaning: 'Pureza, K-beauty, glass skin, embalagens minimalistas (Rosa Beb√™ + √Ågua + P√©rola).' },
            { name: 'Healthy Clean', style: 'minimalista', emotion: 'pureza', meaning: 'Sucos detox, academias, alimenta√ß√£o saud√°vel (Verde Ma√ß√£ + Branco + √Ågua).' },
            { name: 'Farm√°cia & Sa√∫de', style: 'moderno', emotion: 'confian√ßa', meaning: 'Confian√ßa m√©dica, limpeza, rem√©dios, hospitais, marcas como Durex e Nivea.' },
            { name: 'Academia High Performance', style: 'impactante', emotion: 'energia', meaning: 'For√ßa, suor, CrossFit, suplementos.' }
        ],
        'educacao': [
            { name: 'Dark Academia', style: 'vintage', emotion: 'confian√ßa', meaning: 'Livros antigos, Oxford, tradi√ß√£o acad√™mica.' },
            { name: 'Foco Monocrom√°tico (Educa√ß√£o)', style: 'minimalista', emotion: 'confian√ßa', meaning: 'Clareza e autoridade, ideal para materiais did√°ticos e plataformas de EAD.' },
            { name: 'Old Money', style: 'vintage', emotion: 'sofistica√ß√£o', meaning: 'Herdeiros, clube de iate, Ralph Lauren. Cl√°ssico e tradicional em universidades de prest√≠gio.' }
        ],
        'sustentabilidade': [
            { name: 'Floresta Amaz√¥nica', style: 'org√¢nico', emotion: 'calma', meaning: 'Ecologia s√©ria, ONGs, cosm√©ticos naturais (Verde Musgo + Castanho Escuro).' },
            { name: 'Marca de Moda Sustent√°vel', style: 'org√¢nico', emotion: 'pureza', meaning: 'Farm, Osklen, moda consciente (Verde Oliva + Areia + Cru).' },
            { name: 'Vinhos Naturais', style: 'org√¢nico', emotion: 'calma', meaning: 'Vin√≠colas boutique, vinho laranja, slow living.' },
            { name: 'Deserto Boho', style: 'org√¢nico', emotion: 'criatividade', meaning: 'Decora√ß√£o boho, casamento no campo, marcas sustent√°veis.' }
        ],
        'criativo': [
            { name: 'Prim√°rias Pop', style: 'impactante', emotion: 'entusiasmo', meaning: 'Alegria infantil, brinquedos, marcas divertidas (Google, Lego). Energia pura.' },
            { name: 'Anos 70 Retr√¥', style: 'vintage', emotion: 'criatividade', meaning: 'Retr√¥, m√≥veis vintage, marcas que querem personalidade forte (Mostarda + Laranja Queimado + Abacate).' },
            { name: 'Poder Feminino', style: 'impactante', emotion: 'energia', meaning: 'Empoderamento, Barbiecore 2023-2025, marcas de maquiagem ousadas (Rosa Choque + Preto + Dourado).' },
            { name: 'Paleta Tri√°dica (Cria√ß√£o)', style: 'impactante', emotion: 'criatividade', meaning: "Uma paleta rica e equilibrada, perfeita para a diversidade e est√≠mulo visual de projetos criativos." }
        ],
        'classico': [
            { name: 'Harmonia An√°loga', style: 'moderno', emotion: 'calma', meaning: "Oferece um visual harmonioso e agrad√°vel. √â calmante e f√°cil de usar, ideal para passar uma mensagem de unidade e fluxo suave." },
            { name: 'Contraste Complementar', style: 'impactante', emotion: 'energia', meaning: "Garante alto contraste e impacto. √â vibrante e atrai aten√ß√£o rapidamente." },
        ]
    },
    intentMap: {
        'tecnologia': 'Tecnologia', 'sa√∫de': 'Bem-estar', 'alimentos': 'Aconchego', 'luxo': 'Realeza', 'educa√ß√£o': 'Autoridade', 'sustentabilidade': 'Estabilidade', 'criativo': 'Criatividade',
        'confian√ßa': 'Autoridade', 'energia': 'Ousadia', 'calma': 'Serenidade', 'criatividade': 'Criatividade', 'sofistica√ß√£o': 'Realeza', 'entusiasmo': 'Alegria',
        'moderno': 'Tecnologia', 'minimalista': 'Minimalismo', 'vintage': 'Autenticidade', 'retr√¥': 'Autenticidade', 'negrito': 'Destaque', 'impactante': 'Destaque', 'suave': 'Delicadeza', 'org√¢nico': 'Estabilidade',
        'quent': 'Aconchego', 'frio': 'Serenidade', 'neutro': 'Equil√≠brio',
        'alto': 'Destaque', 'baixo': 'Serenidade',
        'sim': 'Estabilidade', 'n√£o': 'Tecnologia'
    }
};

function hexToHsl(hex) {
    let r = 0, g = 0, b = 0;
    if (hex.length == 7) { r = parseInt(hex.substring(1, 3), 16); g = parseInt(hex.substring(3, 5), 16); b = parseInt(hex.substring(5, 7), 16); }
    r /= 255; g /= 255; b /= 255;
    let max = Math.max(r, g, b), min = Math.min(r, g, b);
    let h, s, l = (max + min) / 2;
    if (max == min) { h = s = 0; } else { let d = max - min; s = l > 0.5 ? d / (2 - max - min) : d / (max + min); switch (max) { case r: h = (g - b) / d + (g < b ? 6 : 0); break; case g: h = (b - r) / d + 2; break; case b: h = (r - g) / d + 4; break; } h /= 6; }
    return [Math.round(h * 360), Math.round(s * 100), Math.round(l * 100)];
}

function getDetailedColorName(hexColor) {
    const [h, s, l] = hexToHsl(hexColor);
    if (s < 10) {
        if (l < 10) return { name: 'Preto', intent: 'Poder' };
        if (l < 40) return { name: 'Cinza-escuro', intent: 'Autoridade' };
        if (l < 70) return { name: 'Cinza-claro', intent: 'Minimalismo' };
        if (l < 95) return { name: 'Branco-sujo', intent: 'Naturalidade' };
        return { name: 'Branco', intent: 'Pureza' };
    }
    let baseColor = '';
    if (h >= 345 || h < 15) baseColor = 'Vermelho'; else if (h < 45) baseColor = 'Laranja'; else if (h < 75) baseColor = 'Amarelo'; else if (h < 150) baseColor = 'Verde'; else if (h < 210) baseColor = 'Ciano'; else if (h < 270) baseColor = 'Azul'; else if (h < 315) baseColor = 'Roxo'; else if (h < 345) baseColor = 'Rosa';

    let modifier = '';
    if (l < 25) modifier = 'escuro'; else if (l < 45) modifier = 'm√©dio'; else if (l < 75) modifier = 'claro';

    if (baseColor === 'Vermelho') {
        if (modifier === 'escuro') return { name: 'Bord√¥', intent: 'Luxo' };
        if (s > 80 && l > 50) return { name: 'Escarlate', intent: 'Destaque' };
        return { name: 'Vermelho', intent: 'Paix√£o' };
    }
    if (baseColor === 'Laranja') {
        if (modifier === 'escuro' && h > 30) return { name: 'Ferrugem', intent: 'Vintage' };
        if (modifier === 'escuro') return { name: 'Laranja-queimado', intent: 'A√ß√£o' };
        return { name: 'Laranja', intent: 'Criatividade' };
    }
    if (baseColor === 'Amarelo') {
        if (modifier === 'escuro' && s > 50) return { name: 'Mostarda', intent: 'Personalidade' };
        return { name: 'Amarelo', intent: 'Alegria' };
    }
    if (baseColor === 'Verde') {
        if (modifier === 'escuro') return { name: 'Verde-floresta', intent: 'Estabilidade' };
        if (s < 50) return { name: 'Oliva', intent: 'Natureza' };
        return { name: 'Verde', intent: 'Crescimento' };
    }
    if (baseColor === 'Azul') {
        if (modifier === 'escuro') return { name: 'Azul-marinho', intent: 'Autoridade' };
        if (modifier === 'claro') return { name: 'Azul-celeste', intent: 'Serenidade' };
        return { name: 'Azul', intent: 'Confian√ßa' };
    }
    if (baseColor === 'Roxo') {
        if (s > 60 && l < 40) return { name: 'P√∫rpura', intent: 'Realeza' };
        return { name: 'Roxo', intent: 'Criatividade' };
    }
    if (baseColor === 'Rosa') {
        if (modifier === 'claro') return { name: 'Rosa-beb√™', intent: 'Delicadeza' };
        if (modifier === 'escuro') return { name: 'F√∫csia', intent: 'Ousadia' };
        return { name: 'Rosa', intent: 'Feminilidade' };
    }
    return { name: baseColor || 'Cor Principal', intent: 'Equil√≠brio' };
}

const questions = [
    { q: "Setor principal da marca", o: ["Tecnologia","Sa√∫de","Alimentos","Luxo","Educa√ß√£o","Sustentabilidade","Criativo"], k: "sector" },
    { q: "Emo√ß√£o principal", o: ["Confian√ßa","Energia","Calma","Criatividade","Sofistica√ß√£o","Entusiasmo"], k: "emotion" },
    { q: "Estilo visual", o: ["Moderno/Minimalista","Vintage/Retr√¥","Negrito/Impactante","Suave/Org√¢nico"], k: "style" },
    { q: "P√∫blico-alvo", o: ["Jovem (18-30)","Adulto (30-50)","Todos os p√∫blicos"], k: "audience" },
    { q: "Sensa√ß√£o t√©rmica", o: ["Quente/Aconchegante","Frio/Refrescante","Neutro"], k: "warmth" },
    { q: "N√≠vel de contraste", o: ["Alto contraste","M√©dio","Baixo/Suave"], k: "contrast" },
    { q: "Inspirado na natureza?", o: ["Sim (oceano, floresta‚Ä¶)", "N√£o, mais urbano/tech"], k: "nature" },
    { q: "Cor que voc√™ AMA (opcional)", type:"text", placeholder:"ex: turquesa, dourado‚Ä¶", k:"fav" }
];
let current = 0;
let answers = {};
const wrapper = document.getElementById('card-wrapper');

// Cria estrelas aleat√≥rias no fundo
for(let i=0;i<100;i++){
    const s=document.createElement('div');
    s.className='star';
    s.style.cssText=`width:${Math.random()*3+1}px;height:${s.style.width};left:${Math.random()*100}vw;top:${Math.random()*100}vh;animation-delay:${Math.random()*4}s;`;
    document.body.appendChild(s);
}

// ====================================================================
// FUN√á√ÉO GENERATEPALETTE ORIGINAL
// Mantida 100% da l√≥gica e funcionalidade.
// ====================================================================

function generatePalette(){
    
    // 1. INICIALIZA√á√ÉO E GERA√á√ÉO DA SEMENTE
    let seed = Date.now() + Math.random()*1e8;
    Object.values(answers).join('').split('').forEach(c=>seed += c.charCodeAt(0));
    const rand = (m,M)=>{seed=(seed*9301+49297)%233280; return m+(seed/233280)*(M-m)};
    
    // 2. GERA√á√ÉO DO HUE PRINCIPAL BASEADO NAS RESPOSTAS
    let hue = rand(0,360);
    const sectorKey = answers.sector?.toLowerCase().replace(' ', '');
    const emotionKey = answers.emotion?.toLowerCase().replace(' ', '');
    
    // Ajuste de HUE baseado em setore, emo√ß√£o e calor (multi-fator)
    if (answers.fav?.includes('azul')) hue = rand(200,260);
    else if (answers.fav?.includes('vermelh') || answers.fav?.includes('red')) hue = rand(340,20);
    else if (answers.fav?.includes('verde') || answers.fav?.includes('green')) hue = rand(100,160);
    else if (answers.warmth?.includes('quent')) hue = rand(15, 60); // Cores Quentes (Amarelo, Laranja, Vermelho)
    else if (answers.warmth?.includes('frio')) hue = rand(180, 260); // Cores Frias (Azul, Ciano)
    else if (sectorKey === 'luxo' || emotionKey === 'sofistica√ß√£o') hue = rand(220, 300); // Roxo/Azul Profundo para Luxo
    else if (emotionKey === 'energia' || emotionKey === 'entusiasmo') hue = rand(30, 80); // Laranja/Amarelo

    const colors = [];
    
    // 3. LOOP PARA GERAR 5 CORES COM AJUSTES DIN√ÇMICOS
    for(let i=0;i<5;i++){
        let h = (hue + i*72 + rand(-45,45)) % 360;
        
        // Ajuste de Satura√ß√£o (S) e Luminosidade (L) baseado em Estilo e Contraste
        let s = rand(65, 92);
        if (answers.style?.includes('negrito') || answers.style?.includes('impactante')) s = rand(80, 100);
        if (answers.style?.includes('suave') || answers.style?.includes('org√¢nico')) s = rand(50, 75);

        let l = rand(50, 72);
        if (answers.contrast?.includes('alto')) l = (i % 2 === 0) ? rand(30, 50) : rand(70, 90); // Alterna entre escuro e claro para alto contraste
        else if (answers.contrast?.includes('baixo') || answers.contrast?.includes('suave')) l = rand(65, 85); // Cores claras para baixo contraste
        else if (answers.style?.includes('minimalista')) l = rand(50, 65); // Cores m√©dias e s√≥brias para minimalismo
        
        colors.push(hslToHex(h,s,l));
    }
    
    // 4. RENDERIZA√á√ÉO DA PALETA
    const p = document.getElementById('palette');
    p.innerHTML='';
    colors.forEach((c,i)=>{
        const box = document.createElement('div');
        box.className='h-72 md:h-80 rounded-3xl relative overflow-hidden color-box-shadow';
        box.style.backgroundColor=c;
        box.innerHTML = `<div class="absolute inset-0 bg-gradient-to-t from-black/60 to-transparent"></div>
                         <div class="absolute bottom-6 left-6 text-3xl md:text-4xl font-black ${isLight(c)?'text-black/80':'text-white'} drop-shadow-lg">${c}</div>`;
        p.appendChild(box);
        gsap.fromTo(box,{scale:0.5, rotationZ:360, opacity:0},{scale:1, rotationZ:0, opacity:1, duration:1.5, delay:i*0.2, ease:"back.out(1.7)"});
    });

    
    // 5. AN√ÅLISE MULTIDIMENSIONAL
    
    // A. An√°lise da Cor Prim√°ria (apenas para refer√™ncia)
    const primaryHex = colors[0];
    const { name: primaryColorName, intent: primaryIntent } = getDetailedColorName(primaryHex); 
    const primaryMeaning = colorMeanings.primary[primaryColorName] || { meaning: `Significado de ${primaryColorName} n√£o encontrado.`, intent: 'Equil√≠brio' };
    
    // B. Pontua√ß√£o de Inten√ß√µes (Vota√ß√£o)
    const intentScore = {};
    let highestIntent = 'Default';
    let maxScore = 0;

    Object.keys(answers).forEach(key => {
        if (key === 'fav') return; // Ignora a cor favorita na pontua√ß√£o principal
        
        // Simplifica a resposta para busca no intentMap
        const answerValue = answers[key].toLowerCase().split('/')[0].replace(' ', '');
        const matchedIntent = colorMeanings.intentMap[answerValue];

        if (matchedIntent) {
            intentScore[matchedIntent] = (intentScore[matchedIntent] || 0) + 1;
            if (intentScore[matchedIntent] > maxScore) {
                maxScore = intentScore[matchedIntent];
                highestIntent = matchedIntent;
            }
        }
    });

    // C. Sele√ß√£o do Tema da Paleta (Combo)
    const styleKey = answers.style?.toLowerCase().split('/')[0].replace(' ', '');
    
    let potentialCombos = colorMeanings.combo[sectorKey] || colorMeanings.combo.classico;

    // Filtra combos que correspondem √† EMO√á√ÉO e ESTILO
    let refinedCombos = potentialCombos.filter(combo => {
        const isEmotionMatch = combo.emotion && emotionKey && combo.emotion === emotionKey;
        const isStyleMatch = combo.style && styleKey && combo.style.includes(styleKey);
        
        // Combos que batem em Emo√ß√£o E Estilo t√™m prioridade
        if (isEmotionMatch && isStyleMatch) return true;
        // Combos que batem no Intent Principal t√™m peso
        if (combo.meaning.toLowerCase().includes(highestIntent.toLowerCase())) return true;
        
        return false; // Se n√£o bater, √© descartado para refinar a lista
    });
    
    // Se a filtragem refinada n√£o encontrou nada, volta a usar o filtro por setor
    if (refinedCombos.length === 0) {
        refinedCombos = potentialCombos;
    }
    
    // Garante que n√£o haja combos repetidos (mesmo nome)
    const uniqueCombos = Array.from(new Set(refinedCombos.map(c => c.name)))
                              .map(name => refinedCombos.find(c => c.name === name));
        
    // Seleciona o melhor combo aleatoriamente entre os refinados
    let bestCombo;
    if (uniqueCombos.length > 0) {
        const randomIndex = Math.floor(rand(0, uniqueCombos.length));
        bestCombo = uniqueCombos[randomIndex];
    } else {
        const fallbackOptions = colorMeanings.combo.classico;
        const randomIndex = Math.floor(rand(0, fallbackOptions.length));
        bestCombo = fallbackOptions[randomIndex];
    }
    
    // D. Mensagem de Fechamento (baseada na inten√ß√£o mais votada)
    const intentKey = highestIntent || 'Default';
    const statements = closingStatements[intentKey] || closingStatements['Default'];
    const closingPhrase = statements[Math.floor(rand(0, statements.length))];

    // 6. MONTAGEM DO TEXTO FINAL
    const analysisText = `
        <p class="mb-4">Sua paleta foi ancorada no **${highestIntent.toUpperCase()}**, o tema mais forte de suas escolhas.</p>
        
        <p class="mb-4">A cor principal, **${primaryColorName.toUpperCase()}**, foi gerada a partir do seu perfil e, isoladamente, significa:</p>
        <blockquote class="border-l-4 border-purple-400 pl-4 py-2 italic text-lg text-gray-400">"${primaryMeaning.meaning.replace(/\s*\(.*\)\s*/g, '').trim()}"</blockquote>
        
        <p class="mb-4">Esta combina√ß√£o multidimensional gerou o tema **${bestCombo.name.toUpperCase()}**, que remete a:</p>
        <blockquote class="border-l-4 border-pink-400 pl-4 py-2 italic text-lg text-gray-400">"${bestCombo.meaning}"</blockquote>
        
        <p class="mt-6 font-bold text-cyan-300 text-2xl">${closingPhrase}</p>
    `;
    
    document.getElementById('analysis').innerHTML = analysisText;
    
    // 7. FINALIZA√á√ÉO
    document.getElementById('hexList').innerHTML = colors.map((c,i)=>`<div class="flex justify-between py-2 items-center"><span class="text-gray-400 text-lg">${['Prim√°ria','Secund√°ria 1','Secund√°ria 2','Acento','Fundo'][i]}</span><b class="text-3xl bg-clip-text text-transparent bg-gradient-to-r from-white to-gray-200">${c}</b><button onclick="copySingle('${c}')" class="ml-4 text-cyan-400 hover:text-cyan-300 text-sm"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h12a2 2 0 002-2v-4M8 5l4-4 4 4M8 5h8"></path></svg></button></div>`).join('');
    
    document.getElementById('loading').classList.add('hidden');
    document.getElementById('result').classList.add('visible');
    document.getElementById('quiz').style.display = 'none';
    document.getElementById('mainContainer').classList.add('result-active');
    
    // MUDAN√áA DE COR DO BACKGROUND GRADIENTE (EFEITO AURORA)
    document.getElementById('aurora').style.background = `linear-gradient(45deg, ${colors[0]}, ${colors[1]}, ${colors[2]}, ${colors[3]}, ${colors[4]})`;
    
    window.scrollTo({ top: 0, behavior: 'smooth' });
}

// ====================================================================
// FUN√á√ïES AUXILIARES (HEX, HSL, ETC)
// ====================================================================

function hslToHex(h,s,l){h/=360;s/=100;l/=100;let r,g,b;if(s===0){r=g=b=l}else{const q=l<0.5?l*(1+s):l+s-l*s;const p=2*l-q;r=h2(q,p,h+1/3);g=h2(q,p,h);b=h2(q,p,h-1/3)}return '#'+[r,g,b].map(x=>('0'+Math.round(x*255).toString(16)).slice(-2)).join('').toUpperCase();}
function h2(q,p,t){if(t<0)t++;if(t>1)t--;if(t<1/6)return p+(q-p)*6*t;if(t<0.5)return q;if(t<2/3)return p+(q-p)*(2/3-t)*6;return p;}
function isLight(hex){const [r,g,b]=[1,3,5].map(i=>parseInt(hex.slice(i,i+2),16));return r*0.299+g*0.587+b*0.114>160;}

function copyAll(){
    const text = Array.from(document.querySelectorAll('#hexList b')).map(e=>e.textContent).join('\n');
    navigator.clipboard.writeText(text);
    alert('Paleta copiada!');
}

function copySingle(hexCode) {
    navigator.clipboard.writeText(hexCode);
    alert(`C√≥digo ${hexCode} copiado!`);
}

// Efeito Ripple nos bot√µes
document.querySelectorAll('.ripple-btn').forEach(btn=>{
    btn.addEventListener('click', e=>{
        const r=document.createElement('span');
        const rect=btn.getBoundingClientRect();
        const size=Math.max(rect.width,rect.height)*2;
        r.style.width=r.style.height=size+'px';
        r.style.left=(e.clientX-rect.left-size/2)+'px';
        r.style.top=(e.clientY-rect.top-size/2)+'px';
        r.className='ripple';
        btn.appendChild(r);
        setTimeout(()=>r.remove(),600);
    });
});

// ====================================================================
// FUN√á√ïES DE ANIMA√á√ÉO GSAP (SHATTER & ASSEMBLE)
// ====================================================================

function shatterCard(callback) {
    const card = wrapper.querySelector('.card');
    if(!card) return callback();

    // Cria as pe√ßas do card quebrado
    const pieces = 15;
    const bounds = card.getBoundingClientRect();
    const cardCenter = { x: bounds.width / 2, y: bounds.height / 2 };

    for(let i = 0; i < pieces; i++) {
        const piece = document.createElement('div');
        piece.className = 'piece';
        const size = 50 + Math.random()*80;
        piece.style.width = size + 'px';
        piece.style.height = size + 'px';
        piece.style.background = getComputedStyle(card).background;
        piece.style.left = (Math.random() * 80 + 10) + '%';
        piece.style.top = (Math.random() * 80 + 10) + '%';
        wrapper.appendChild(piece);

        // Anima√ß√£o GSAP: Lan√ßa as pe√ßas para longe
        gsap.to(piece, {
            x: Math.random()*1000 - 500, // Longe no eixo X
            y: Math.random()*1000 - 500, // Longe no eixo Y
            rotation: Math.random()*1440 - 720, // Rota√ß√£o extrema
            scale: 0.1, // Encolhe
            opacity: 0,
            duration: 1.5,
            ease: "power3.out",
            delay: i*0.05,
            onComplete: () => piece.remove()
        });
    }
    // Fade out e remo√ß√£o do card principal
    gsap.to(card, {opacity: 0, y: -50, scale: 0.8, duration: 0.5, ease: "power2.in", onComplete: callback});
}

function assembleCard() {
    wrapper.innerHTML = '';
    const q = questions[current];

    // Card principal
    const card = document.createElement('div');
    card.className = 'card';
    card.innerHTML = `
      <div class="text-lg text-gray-500 mb-6 font-medium">Pergunta ${current+1} de ${questions.length}</div>
      <h3 class="text-5xl font-black mb-12 bg-clip-text text-transparent bg-gradient-to-r from-sky-400 to-fuchsia-500 leading-snug">
        ${q.q}
      </h3>`;

    if(q.type === "text") {
        const input = document.createElement('input');
        input.type = "text";
        input.placeholder = q.placeholder;
        input.value = answers.fav || '';
        input.id = "favInput";
        input.className = "w-full p-6 text-2xl bg-gray-900/80 border border-purple-500/50 rounded-2xl focus:border-purple-400 outline-none ripple-btn text-white transition placeholder-gray-600";
        card.appendChild(input);
    } else {
        q.o.forEach(opt => {
            const btn = document.createElement('button');
            btn.textContent = opt;
            const isSelected = answers[q.k] === opt.toLowerCase().split('/')[0].replace(' ', ''); // Ajuste para bater com o formato do answer
            btn.className = `block w-full text-left p-6 my-4 text-xl rounded-2xl transition ripple-btn font-medium hover:scale-[1.01] hover:shadow-lg hover:shadow-purple-900/30 ${isSelected ? 'bg-purple-600/70 border-purple-400 shadow-xl shadow-purple-800/40' : 'bg-gray-900/70 hover:bg-purple-900/40 border border-gray-700/50'}`;
            btn.onclick = () => selectAnswer(opt, q.k);
            card.appendChild(btn);
        });
    }
    wrapper.appendChild(card);
    card.style.opacity = 0; // Inicialmente invis√≠vel

    // Anima√ß√£o GSAP: Montagem do card principal
    gsap.fromTo(card, {y: 50, scale: 0.9, opacity: 0}, {y: 0, scale: 1, opacity: 1, duration: 1, ease: "back.out(1.2)", delay: 0.2});

    // Pe√ßas "estelares" de montagem
    const pieces = 12;
    for(let i = 0; i < pieces; i++) {
        const p = document.createElement('div');
        p.className = 'piece';
        const size = 30 + Math.random()*50;
        p.style.width = size + 'px';
        p.style.height = size + 'px';
        p.style.background = 'rgba(30,30,60,0.9)';
        p.style.border = '1px solid rgba(150,100,255,0.4)';

        // Posi√ß√£o inicial fora do centro, com rota√ß√£o e escala zero
        p.style.left = (50 + Math.random()*100 - 50) + '%';
        p.style.top = (50 + Math.random()*100 - 50) + '%';
        p.style.transform = `rotate(${Math.random()*360}deg) scale(0.1)`;
        
        wrapper.appendChild(p);
        
        // Anima√ß√£o GSAP: Puxa as pe√ßas para o centro e as remove
        gsap.to(p, {
            x: (Math.random()*2 - 1) * 50, // Pequeno movimento aleat√≥rio perto do centro
            y: (Math.random()*2 - 1) * 50, 
            scale: 1, 
            opacity: 0, 
            duration: 1.5, 
            delay: i*0.08, 
            ease: "power2.inOut",
            onComplete: () => p.remove()
        });
    }

    // Controle dos bot√µes
    document.getElementById('backBtn').classList.toggle('hidden', current === 0 || current === questions.length - 1);
    document.getElementById('generateBtn').classList.toggle('hidden', current !== questions.length - 1);
}

function selectAnswer(value, key) {
    // A resposta √© armazenada em min√∫sculas e limpa para evitar problemas de compara√ß√£o
    answers[key] = value.toLowerCase().split('/')[0].replace(' ', '');
    
    if (current < questions.length - 1) {
        current++;
        shatterCard(() => setTimeout(assembleCard, 400)); // Espera a anima√ß√£o de quebra
    } else {
         // Atualiza o card de texto no final, se o usu√°rio clicar
         if(questions[current].type === "text") {
             answers.fav = document.getElementById('favInput').value.toLowerCase();
         }
         // O bot√£o "Gerar Paleta" j√° estar√° vis√≠vel, o clique final deve ser nele
    }
}

document.getElementById('backBtn').onclick = () => {
    if(current > 0) { 
        if(questions[current].type === "text") {
            // Salva a resposta do campo de texto antes de voltar
            answers.fav = document.getElementById('favInput').value.toLowerCase();
        }
        current--; 
        shatterCard(() => setTimeout(assembleCard, 400));
    }
};

document.getElementById('generateBtn').onclick = () => {
    if(questions[current].type === "text") {
        answers.fav = document.getElementById('favInput').value.toLowerCase();
    }
    
    // Anima√ß√£o de quebra final antes de ir para o loading
    shatterCard(() => {
        document.getElementById('loading').classList.remove('hidden');
        document.getElementById('quiz').style.opacity = 0;
        setTimeout(() => {
            document.getElementById('quiz').style.display = 'none';
            generatePalette(); // Chama a fun√ß√£o de gera√ß√£o ap√≥s o delay de loading simulado
        }, 2800);
    });
};

// Inicia a aplica√ß√£o
assembleCard();
</script>
</body>
</html>
