<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
  <title>Asthro | Portal de Freelancers</title>

  <link rel="icon" type="image/png" href="https://i.imgur.com/3HqwIPk.png">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/particles.js/2.0.0/particles.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Archivo:wght@700&family=Manrope:wght@400;600;700&display=swap" rel="stylesheet">

  <style>
    *{ box-sizing:border-box; }
    body{
      font-family:'Manrope',sans-serif;
      background:#0b0b12;
      color:#edf1f7;
      overflow-x:hidden;
    }
    #particles-js{
      position:fixed; inset:0;
      width:100%; height:100%;
      z-index:0;
      background: radial-gradient(1200px 700px at 10% 20%, rgba(102,39,255,0.18), transparent 60%),
                  radial-gradient(900px 700px at 90% 70%, rgba(11,244,237,0.14), transparent 55%),
                  #070712;
    }
    .layer{ position:relative; z-index:2; }

    .glass{
      background: rgba(10,10,15,0.64);
      border: 1px solid rgba(255,255,255,0.10);
      backdrop-filter: blur(14px);
      -webkit-backdrop-filter: blur(14px);
      border-radius: 1.25rem;
      box-shadow: 0 18px 50px rgba(0,0,0,0.55);
    }
    .neon{
      border: 1px solid rgba(102,39,255,0.40);
      box-shadow: 0 0 22px rgba(102,39,255,0.20), 0 0 12px rgba(11,244,237,0.08);
    }
    .gradient-text{
      background: linear-gradient(135deg,#6627ff,#0bf4ed);
      -webkit-background-clip:text;
      -webkit-text-fill-color:transparent;
    }
    .btn{
      border-radius:999px;
      font-weight:800;
      transition: transform .2s ease, box-shadow .2s ease, filter .2s ease;
      user-select:none;
    }
    .btn-primary{
      background: linear-gradient(135deg,#6627ff,#0bf4ed);
      border: 1px solid rgba(11,244,237,0.55);
      box-shadow: 0 0 16px rgba(102,39,255,0.25);
    }
    .btn-primary:hover{
      transform: translateY(-2px);
      box-shadow: 0 0 26px rgba(11,244,237,0.45);
      filter: brightness(1.05);
    }
    .btn-ghost{
      background: rgba(255,255,255,0.06);
      border: 1px solid rgba(255,255,255,0.12);
    }
    .btn-ghost:hover{
      transform: translateY(-2px);
      box-shadow: 0 10px 22px rgba(0,0,0,0.35);
    }

    .input{
      width:100%;
      background: rgba(255,255,255,0.04);
      border: 1px solid rgba(255,255,255,0.12);
      border-radius: 1rem;
      padding: .85rem 1rem;
      color:#edf1f7;
      outline:none;
      transition: border .2s ease, box-shadow .2s ease;
    }
    .input:focus{
      border-color: rgba(11,244,237,0.65);
      box-shadow: 0 0 0 4px rgba(11,244,237,0.10);
    }

    .chip{
      padding:.35rem .65rem;
      border-radius:999px;
      font-size:.75rem;
      border:1px solid rgba(255,255,255,0.12);
      background: rgba(255,255,255,0.05);
      color:#cbd5e1;
      white-space:nowrap;
    }

    .toast{
      position:fixed;
      bottom:18px;
      left:50%;
      transform:translateX(-50%);
      z-index:999999;
      max-width:min(560px,92vw);
      display:none;
      padding:.85rem 1.1rem;
      border-radius:999px;
      background: rgba(10,10,15,0.92);
      border: 1px solid rgba(11,244,237,0.30);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      box-shadow: 0 12px 30px rgba(0,0,0,0.55);
      text-align:center;
      font-weight:800;
      color:#e2e8f0;
    }
    .toast.show{ display:block; }

    /* Layout Dashboard */
    .app-shell{
      display:grid;
      grid-template-columns: 300px 1fr;
      min-height: 100vh;
    }
    @media (max-width: 1024px){
      .app-shell{ grid-template-columns: 1fr; }
      .sidebar{ position:fixed; left:-100%; top:0; height:100vh; width:min(300px,85vw); transition:left .25s ease; z-index:50; }
      .sidebar.open{ left:0; }
      .overlay{
        position:fixed; inset:0; background:rgba(0,0,0,0.65);
        display:none; z-index:49;
      }
      .overlay.show{ display:block; }
    }

    .menu-btn{
      width:100%;
      text-align:left;
      padding:.85rem 1rem;
      border-radius:1rem;
      border:1px solid rgba(255,255,255,0.10);
      background: rgba(255,255,255,0.04);
      transition: all .2s ease;
      font-weight:800;
      color:#edf1f7;
    }
    .menu-btn:hover{
      transform: translateY(-1px);
      border-color: rgba(11,244,237,0.45);
      box-shadow: 0 10px 22px rgba(0,0,0,0.35);
    }
    .menu-btn.active{
      background: linear-gradient(135deg, rgba(102,39,255,0.25), rgba(11,244,237,0.14));
      border-color: rgba(11,244,237,0.55);
      color:#0bf4ed;
      box-shadow: 0 0 18px rgba(11,244,237,0.12);
    }

    .project-card{
      border-radius:1.25rem;
      border: 1px solid rgba(102,39,255,0.25);
      background: rgba(31,41,55,0.52);
      box-shadow: 0 14px 34px rgba(0,0,0,0.45);
      overflow:hidden;
      transition: transform .2s ease, border .2s ease, box-shadow .2s ease;
    }
    .project-card:hover{
      transform: translateY(-5px);
      border-color: rgba(11,244,237,0.55);
      box-shadow: 0 18px 44px rgba(0,0,0,0.55);
    }
    .top-line{ height:4px; background: linear-gradient(90deg,#6627ff,#0bf4ed); opacity:.95; }

    .badge-open{
      background: rgba(11,244,237,0.12);
      border:1px solid rgba(11,244,237,0.28);
      color:#0bf4ed;
      padding:.25rem .6rem;
      border-radius:999px;
      font-size:.75rem;
      font-weight:900;
      letter-spacing:.02em;
    }
    .badge-closed{
      background: rgba(255,255,255,0.08);
      border:1px solid rgba(255,255,255,0.12);
      color:#cbd5e1;
      padding:.25rem .6rem;
      border-radius:999px;
      font-size:.75rem;
      font-weight:900;
      letter-spacing:.02em;
    }

    /* Modal */
    .modal{
      position:fixed; inset:0;
      display:none;
      align-items:center; justify-content:center;
      padding:1rem;
      z-index:9999;
      background: rgba(0,0,0,0.72);
    }
    .modal.open{ display:flex; }
    .modal-box{
      width:min(980px,100%);
      max-height:90vh;
      overflow:auto;
      border-radius:1.25rem;
      position:relative;
    }
    .xbtn{
      position:absolute;
      top:12px; right:14px;
      width:42px; height:42px;
      border-radius:999px;
      background: rgba(255,255,255,0.06);
      border:1px solid rgba(255,255,255,0.14);
      color:#edf1f7;
      font-size:1.4rem;
      display:flex;
      align-items:center;
      justify-content:center;
      cursor:pointer;
      transition: transform .2s ease, background .2s ease;
      z-index:50;
    }
    .xbtn:hover{
      transform: scale(1.05);
      background: rgba(11,244,237,0.12);
    }
  </style>
</head>

<body>
  <div id="particles-js"></div>

  <!-- TOAST -->
  <div id="toast" class="toast">Mensagem</div>

  <!-- OVERLAY (mobile sidebar) -->
  <div id="overlay" class="overlay"></div>

  <!-- AUTH SCREEN (TELA PROFISSIONAL INICIAL) -->
  <main id="authScreen" class="layer min-h-screen flex items-center justify-center px-4 py-10">
    <div class="w-full max-w-6xl grid grid-cols-1 lg:grid-cols-12 gap-6 items-center">
      <!-- Left -->
      <section class="lg:col-span-6 glass neon p-8 md:p-10">
        <div class="flex items-center gap-4">
          <img
            src="https://raw.githubusercontent.com/MateusZito2024/Cria-o-de-Sites/refs/heads/main/LOGO%20PNG.png"
            alt="Asthro"
            class="h-20 w-auto select-none"
            style="image-rendering:auto"
            draggable="false"
          />
          <div>
            <div class="text-sm text-gray-300 font-semibold">Asthro Network</div>
            <div class="text-2xl md:text-3xl font-extrabold gradient-text">Portal de Freelancers</div>
          </div>
        </div>

        <h1 class="mt-6 text-3xl md:text-5xl font-extrabold leading-tight" style="font-family:'Archivo',sans-serif;">
          Entre no portal e pegue<br/>
          <span class="gradient-text">projetos premium</span>
        </h1>

        <p class="mt-4 text-gray-300 text-base md:text-lg max-w-xl">
          Um sistema limpo, organizado e s√©rio ‚Äî feito para freelancers entenderem tudo r√°pido,
          sem polui√ß√£o visual, com est√©tica Asthro.
        </p>

        <div class="mt-6 flex flex-wrap gap-2">
          <span class="chip">Projetos reais</span>
          <span class="chip">Inscri√ß√£o organizada</span>
          <span class="chip">Perfil profissional</span>
          <span class="chip">Sele√ß√£o premium</span>
        </div>

        <div class="mt-8 grid grid-cols-1 sm:grid-cols-3 gap-4">
          <div class="glass p-4">
            <div class="text-xs text-gray-300 font-bold">Projetos Ativos</div>
            <div id="statOpen" class="text-3xl font-extrabold gradient-text">--</div>
          </div>
          <div class="glass p-4">
            <div class="text-xs text-gray-300 font-bold">Freelancers Online</div>
            <div id="statOnline" class="text-3xl font-extrabold gradient-text">--</div>
          </div>
          <div class="glass p-4">
            <div class="text-xs text-gray-300 font-bold">Inscri√ß√µes</div>
            <div id="statApps" class="text-3xl font-extrabold gradient-text">--</div>
          </div>
        </div>
      </section>

      <!-- Right (Auth box) -->
      <section class="lg:col-span-6 glass neon p-8 md:p-10">
        <div class="flex items-center justify-between gap-3 flex-wrap">
          <div>
            <h2 class="text-2xl md:text-3xl font-extrabold gradient-text" style="font-family:'Archivo',sans-serif;">
              Acessar Portal
            </h2>
            <p class="text-gray-300 mt-1 text-sm">
              Entre com sua conta ou crie uma nova em segundos.
            </p>
          </div>

          <div class="flex gap-2">
            <button id="tabLogin" class="btn btn-ghost px-5 py-2 text-sm active" style="border-color:rgba(11,244,237,0.45); color:#0bf4ed;">
              Login
            </button>
            <button id="tabRegister" class="btn btn-ghost px-5 py-2 text-sm">
              Criar conta
            </button>
          </div>
        </div>

        <div class="mt-6 space-y-3">
          <input id="authName" class="input hidden" placeholder="Seu nome (para cadastro)"/>
          <input id="authEmail" class="input" placeholder="Seu e-mail"/>
          <input id="authPass" class="input" type="password" placeholder="Sua senha"/>
        </div>

        <div class="mt-5 grid grid-cols-1 gap-3">
          <button id="btnAuthMain" class="btn btn-primary px-6 py-3">
            Entrar
          </button>

          <button id="btnGoogle" class="btn btn-ghost px-6 py-3">
            Entrar com Google
          </button>
        </div>

        <div class="mt-5 flex items-center justify-between gap-3 flex-wrap">
          <div class="text-xs text-gray-400">
            üîí Autentica√ß√£o segura com Firebase Auth
          </div>

          <button id="btnEnterDemo" class="text-xs font-extrabold gradient-text hover:opacity-90">
            Entrar em modo DEMO
          </button>
        </div>

        <div class="mt-6 p-4 rounded-2xl"
             style="background: rgba(102,39,255,0.08); border:1px dashed rgba(102,39,255,0.35);">
          <div class="text-sm font-extrabold text-gray-100">Importante</div>
          <div class="text-sm text-gray-300 mt-1">
            Se o Firebase n√£o estiver configurado, o portal entra em <b>modo DEMO</b> automaticamente.
          </div>
        </div>
      </section>
    </div>
  </main>

  <!-- DASHBOARD APP -->
  <main id="appScreen" class="layer hidden">
    <div class="app-shell">
      <!-- Sidebar -->
      <aside id="sidebar" class="sidebar glass neon p-5">
        <div class="flex items-center justify-between gap-3">
          <div class="flex items-center gap-3">
            <img
              src="https://raw.githubusercontent.com/MateusZito2024/Cria-o-de-Sites/refs/heads/main/LOGO%20PNG.png"
              alt="Asthro"
              class="h-14 w-auto select-none"
              draggable="false"
            />
          </div>

          <button id="btnCloseSidebar" class="btn btn-ghost px-4 py-2 lg:hidden">
            ‚úï
          </button>
        </div>

        <div class="mt-5 p-4 rounded-2xl"
             style="background: linear-gradient(135deg, rgba(102,39,255,0.14), rgba(11,244,237,0.07));
                    border: 1px solid rgba(11,244,237,0.18);">
          <div class="text-xs text-gray-300 font-bold">Logado como</div>
          <div id="sbName" class="text-lg font-extrabold gradient-text mt-1">--</div>
          <div id="sbEmail" class="text-xs text-gray-300 mt-1">--</div>
        </div>

        <nav class="mt-5 space-y-2">
          <button class="menu-btn active" data-page="pageProjects">üìå Projetos</button>
          <button class="menu-btn" data-page="pageApps">üì® Minhas inscri√ß√µes</button>
          <button class="menu-btn" data-page="pageProfile">üë§ Meu perfil</button>
          <button class="menu-btn" data-page="pageSettings">‚öôÔ∏è Prefer√™ncias</button>
        </nav>

        <div class="mt-5 space-y-3">
          <button id="btnLogout" class="btn btn-ghost w-full px-6 py-3">
            Sair
          </button>

          <a href="https://asthro.com.br" target="_blank"
             class="btn btn-primary w-full px-6 py-3 text-center block">
            Site Asthro
          </a>
        </div>

        <div class="mt-6 text-[10px] text-gray-500 uppercase tracking-widest text-center">
          ¬© 2026 ‚Ä¢ Asthro Network
        </div>
      </aside>

      <!-- Content -->
      <section class="p-5 md:p-8">
        <!-- Topbar -->
        <header class="flex items-center justify-between gap-3 mb-6">
          <div>
            <h2 id="pageTitle" class="text-2xl md:text-3xl font-extrabold gradient-text" style="font-family:'Archivo',sans-serif;">
              Projetos
            </h2>
            <p id="pageSubtitle" class="text-gray-300 text-sm mt-1">
              Encontre vagas compat√≠veis com seu perfil e se inscreva.
            </p>
          </div>

          <div class="flex items-center gap-2">
            <button id="btnOpenSidebar" class="btn btn-ghost px-4 py-2 lg:hidden">
              ‚ò∞ Menu
            </button>
            <button id="btnRefresh" class="btn btn-ghost px-5 py-2">
              Atualizar
            </button>
          </div>
        </header>

        <!-- PAGES -->
        <!-- Projects -->
        <div id="pageProjects" class="page">
          <div class="glass neon p-6">
            <div class="flex flex-col lg:flex-row gap-4 justify-between">
              <div class="w-full lg:max-w-xl">
                <div class="text-sm text-gray-300 font-bold">Filtro r√°pido</div>
                <div class="mt-3 grid grid-cols-1 sm:grid-cols-2 gap-3">
                  <input id="searchInput" class="input" placeholder="Buscar (ex: Landing Page, Motion, Branding...)"/>

                  <select id="categoryFilter" class="input">
                    <option value="">Categoria (todas)</option>
                    <option value="Design">Design</option>
                    <option value="Web">Web</option>
                    <option value="Social Media">Social Media</option>
                    <option value="Motion">Motion</option>
                    <option value="Branding">Branding</option>
                  </select>

                  <select id="levelFilter" class="input">
                    <option value="">N√≠vel (todos)</option>
                    <option value="Iniciante">Iniciante</option>
                    <option value="Intermedi√°rio">Intermedi√°rio</option>
                    <option value="Avan√ßado">Avan√ßado</option>
                  </select>

                  <select id="typeFilter" class="input">
                    <option value="">Tipo (todos)</option>
                    <option value="Remoto">Remoto</option>
                    <option value="H√≠brido">H√≠brido</option>
                    <option value="Presencial">Presencial</option>
                  </select>
                </div>

                <div class="mt-3 flex gap-2 flex-wrap">
                  <button id="btnApplyFilters" class="btn btn-primary px-6 py-3">
                    Aplicar filtros
                  </button>
                  <button id="btnClearFilters" class="btn btn-ghost px-6 py-3">
                    Limpar
                  </button>
                </div>
              </div>

              <div class="w-full lg:max-w-md">
                <div class="p-5 rounded-2xl"
                     style="background: rgba(11,244,237,0.06); border:1px solid rgba(11,244,237,0.18);">
                  <div class="text-sm font-extrabold" style="color:#0bf4ed;">Padr√£o Asthro</div>
                  <div class="text-sm text-gray-300 mt-1">
                    Clareza, est√©tica e entrega. Seu perfil completo aumenta MUITO sua sele√ß√£o.
                  </div>
                  <div class="mt-3 flex flex-wrap gap-2">
                    <span class="chip">Portf√≥lio forte</span>
                    <span class="chip">Resposta r√°pida</span>
                    <span class="chip">Qualidade</span>
                  </div>
                </div>
              </div>
            </div>

            <div class="mt-6 grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-5" id="projectsGrid"></div>
            <div id="projectsEmpty" class="hidden mt-6 text-center text-gray-300">
              Nenhum projeto encontrado com esses filtros.
            </div>
          </div>
        </div>

        <!-- Applications -->
        <div id="pageApps" class="page hidden">
          <div class="glass neon p-6">
            <h3 class="text-xl md:text-2xl font-extrabold gradient-text" style="font-family:'Archivo',sans-serif;">
              Minhas inscri√ß√µes
            </h3>
            <p class="text-gray-300 mt-1 text-sm">
              Aqui voc√™ acompanha os projetos em que voc√™ se inscreveu.
            </p>

            <div id="appsList" class="mt-5 grid grid-cols-1 gap-4"></div>
            <div id="appsEmpty" class="hidden mt-5 text-center text-gray-300">
              Voc√™ ainda n√£o se inscreveu em nenhum projeto.
            </div>
          </div>
        </div>

        <!-- Profile -->
        <div id="pageProfile" class="page hidden">
          <div class="grid grid-cols-1 xl:grid-cols-12 gap-5">
            <div class="xl:col-span-5 glass neon p-6">
              <h3 class="text-xl md:text-2xl font-extrabold gradient-text" style="font-family:'Archivo',sans-serif;">
                Meu perfil
              </h3>
              <p class="text-gray-300 mt-1 text-sm">
                Preencha com capricho. Isso te destaca.
              </p>

              <div class="mt-4 space-y-3">
                <input id="profileName" class="input" placeholder="Seu nome"/>
                <input id="profileRole" class="input" placeholder="Sua √°rea (ex: Web Designer / Motion / Dev)"/>
                <input id="profilePortfolio" class="input" placeholder="Link do portf√≥lio (Behance, Site, Drive...)"/>
                <input id="profileSkills" class="input" placeholder="Skills (ex: Figma, After Effects, React...)"/>
                <textarea id="profileBio" class="input" rows="4" placeholder="Bio r√°pida (objetiva e profissional)"></textarea>

                <button id="btnSaveProfile" class="btn btn-primary w-full px-6 py-3">
                  Salvar perfil
                </button>
              </div>

              <div class="mt-4 text-xs text-gray-400">
                üîí Esses dados ficam salvos no seu usu√°rio (Firestore).
              </div>
            </div>

            <div class="xl:col-span-7 glass neon p-6">
              <h3 class="text-xl md:text-2xl font-extrabold gradient-text" style="font-family:'Archivo',sans-serif;">
                Preview do seu cart√£o
              </h3>
              <p class="text-gray-300 mt-1 text-sm">
                Como a Asthro v√™ voc√™ dentro do sistema.
              </p>

              <div class="mt-5 p-6 rounded-2xl"
                   style="background: linear-gradient(135deg, rgba(102,39,255,0.15), rgba(11,244,237,0.08));
                          border:1px solid rgba(11,244,237,0.18);">
                <div class="flex items-start justify-between gap-4">
                  <div>
                    <div id="previewName" class="text-2xl font-extrabold">Seu nome aqui</div>
                    <div id="previewRole" class="text-gray-300 mt-1">Sua √°rea aqui</div>

                    <div id="previewChips" class="mt-3 flex flex-wrap gap-2">
                      <span class="chip">skills</span>
                      <span class="chip">portfolio</span>
                      <span class="chip">Asthro standard</span>
                    </div>
                  </div>

                  <div class="w-16 h-16 rounded-full flex items-center justify-center"
                       style="background: rgba(255,255,255,0.08); border:1px solid rgba(255,255,255,0.12);">
                    <span class="gradient-text font-extrabold text-2xl">‚òÖ</span>
                  </div>
                </div>

                <div id="previewBio" class="text-gray-300 mt-4 text-sm">
                  Uma bio bem escrita te destaca. Mostre est√©tica, t√©cnica e entrega.
                </div>

                <div class="mt-4 flex gap-3 flex-wrap">
                  <a id="previewPortfolio" href="#" target="_blank"
                     class="btn btn-ghost px-5 py-2 text-sm hidden text-center">
                    Abrir portf√≥lio
                  </a>
                  <span class="chip">Atualiza automaticamente</span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Settings -->
        <div id="pageSettings" class="page hidden">
          <div class="glass neon p-6">
            <h3 class="text-xl md:text-2xl font-extrabold gradient-text" style="font-family:'Archivo',sans-serif;">
              Prefer√™ncias
            </h3>
            <p class="text-gray-300 mt-1 text-sm">
              Ajustes visuais simples para deixar confort√°vel.
            </p>

            <div class="mt-5 grid grid-cols-1 md:grid-cols-2 gap-4">
              <div class="p-5 rounded-2xl"
                   style="background: rgba(255,255,255,0.05); border:1px solid rgba(255,255,255,0.10);">
                <div class="text-sm font-extrabold text-gray-100">Part√≠culas</div>
                <div class="text-sm text-gray-300 mt-1">Se quiser o site mais ‚Äúclean‚Äù, desative aqui.</div>
                <button id="btnToggleParticles" class="btn btn-ghost px-6 py-3 mt-4 w-full">
                  Desativar part√≠culas
                </button>
              </div>

              <div class="p-5 rounded-2xl"
                   style="background: rgba(11,244,237,0.06); border:1px solid rgba(11,244,237,0.18);">
                <div class="text-sm font-extrabold" style="color:#0bf4ed;">Dica</div>
                <div class="text-sm text-gray-300 mt-1">
                  O segredo do profissional √©: <b>foco</b> + <b>organiza√ß√£o</b> + <b>clareza</b>.
                </div>
                <div class="mt-3 flex flex-wrap gap-2">
                  <span class="chip">Sem excesso</span>
                  <span class="chip">Info r√°pida</span>
                  <span class="chip">Visual premium</span>
                </div>
              </div>
            </div>
          </div>
        </div>

      </section>
    </div>
  </main>

  <!-- PROJECT MODAL -->
  <div id="projectModal" class="modal">
    <div class="modal-box glass neon">
      <button id="closeProjectModal" class="xbtn">√ó</button>

      <div class="p-6 md:p-8">
        <div class="flex flex-col md:flex-row md:items-start justify-between gap-4">
          <div>
            <div class="flex items-center gap-2 flex-wrap">
              <span id="modalStatus" class="badge-open">ABERTO</span>
              <span id="modalCategory" class="chip">Categoria</span>
              <span id="modalType" class="chip">Remoto</span>
              <span id="modalLevel" class="chip">Intermedi√°rio</span>
            </div>
            <h3 id="modalTitle" class="text-3xl md:text-4xl font-extrabold mt-3 gradient-text" style="font-family:'Archivo',sans-serif;">
              T√≠tulo
            </h3>
            <p id="modalShort" class="text-gray-300 mt-3 text-base md:text-lg">
              Descri√ß√£o curta
            </p>
          </div>

          <div class="flex flex-col gap-2 min-w-[240px]">
            <div class="glass p-4">
              <div class="text-xs text-gray-300 font-bold">Or√ßamento</div>
              <div id="modalBudget" class="text-2xl font-extrabold gradient-text">R$ --</div>
            </div>
            <div class="glass p-4">
              <div class="text-xs text-gray-300 font-bold">Prazo</div>
              <div id="modalDeadline" class="text-xl font-extrabold text-gray-100">--</div>
            </div>
          </div>
        </div>

        <div class="mt-6 grid grid-cols-1 lg:grid-cols-12 gap-5">
          <div class="lg:col-span-8">
            <div class="glass p-5">
              <h4 class="text-xl font-extrabold gradient-text" style="font-family:'Archivo',sans-serif;">Detalhes</h4>
              <p id="modalDescription" class="text-gray-300 mt-2 leading-relaxed">
                Conte√∫do do projeto...
              </p>

              <div class="mt-4">
                <div class="text-sm text-gray-200 font-extrabold">Skills desejadas</div>
                <div id="modalSkills" class="mt-2 flex flex-wrap gap-2"></div>
              </div>
            </div>
          </div>

          <div class="lg:col-span-4">
            <div class="glass p-5">
              <h4 class="text-xl font-extrabold gradient-text" style="font-family:'Archivo',sans-serif;">Inscri√ß√£o</h4>
              <p class="text-gray-300 text-sm mt-2">
                Envie uma mini mensagem e um link do seu portf√≥lio.
              </p>

              <div class="mt-4 space-y-3">
                <input id="applyPortfolio" class="input" placeholder="Seu portf√≥lio (opcional)"/>
                <textarea id="applyMessage" class="input" rows="4" placeholder="Mensagem (ex: por que voc√™ √© ideal?)"></textarea>

                <button id="btnApplyProject" class="btn btn-primary w-full px-6 py-3">
                  Inscrever-se nesse projeto
                </button>
              </div>

              <div class="mt-4 text-xs text-gray-400">
                ‚ö° Inscri√ß√µes ficam registradas no sistema.
              </div>
            </div>
          </div>
        </div>

      </div>
    </div>
  </div>

  <script>
    // Part√≠culas
    let particlesEnabled = true;
    function initParticles(){
      particlesJS('particles-js', {
        particles: {
          number: { value: window.innerWidth <= 768 ? 70 : 160, density: { enable: true, value_area: 800 } },
          color: { value: ['#6627ff', '#0bf4ed', '#30fca9'] },
          shape: { type: 'circle' },
          opacity: { value: 0.75 },
          size: { value: 4, random: true },
          line_linked: { enable: true, distance: 120, color: '#0bf4ed', opacity: 0.5, width: 1 },
          move: { enable: true, speed: 1, random: true, out_mode: 'out' }
        },
        interactivity: {
          detect_on: 'canvas',
          events: { onhover: { enable: true, mode: 'repulse' }, onclick: { enable: true, mode: 'push' }, resize: true },
          modes: { repulse: { distance: 60, duration: 0.12 }, push: { particles_nb: 6 } }
        },
        retina_detect: true
      });
    }
    initParticles();

    // Toast
    const toastEl = document.getElementById('toast');
    let toastTimer = null;
    function showToast(msg){
      toastEl.textContent = msg;
      toastEl.classList.add('show');
      clearTimeout(toastTimer);
      toastTimer = setTimeout(() => toastEl.classList.remove('show'), 2600);
    }

    function escapeHtml(str){
      return String(str || "")
        .replaceAll("&","&amp;")
        .replaceAll("<","&lt;")
        .replaceAll(">","&gt;")
        .replaceAll('"',"&quot;")
        .replaceAll("'","&#039;");
    }
  </script>

  <script type="module">
    /**
     * ‚úÖ CONFIGURE SEU FIREBASE AQUI
     * Firebase Console > Configura√ß√µes do projeto > Seus apps > Web
     */
    const firebaseConfig = {
      apiKey: "SUA_API_KEY_AQUI",
      authDomain: "SEU_AUTH_DOMAIN_AQUI",
      projectId: "SEU_PROJECT_ID_AQUI",
      storageBucket: "SEU_STORAGE_BUCKET_AQUI",
      messagingSenderId: "SEU_MESSAGING_SENDER_ID_AQUI",
      appId: "SEU_APP_ID_AQUI"
    };

    const isFirebaseReady = !!firebaseConfig.apiKey && !firebaseConfig.apiKey.includes("SUA_");

    // Firebase imports seguros (SEM dar erro de vari√°vel n√£o declarada)
    let initializeApp, getAuth, getFirestore;
    let createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged, signOut;
    let GoogleAuthProvider, signInWithPopup, updateProfile;
    let collection, getDocs, query, where, orderBy, addDoc, serverTimestamp, doc, setDoc, getDoc;

    let auth = null;
    let db = null;

    if (isFirebaseReady){
      const fbApp = await import("https://www.gstatic.com/firebasejs/10.12.5/firebase-app.js");
      const fbAuth = await import("https://www.gstatic.com/firebasejs/10.12.5/firebase-auth.js");
      const fbDb = await import("https://www.gstatic.com/firebasejs/10.12.5/firebase-firestore.js");

      initializeApp = fbApp.initializeApp;

      getAuth = fbAuth.getAuth;
      createUserWithEmailAndPassword = fbAuth.createUserWithEmailAndPassword;
      signInWithEmailAndPassword = fbAuth.signInWithEmailAndPassword;
      onAuthStateChanged = fbAuth.onAuthStateChanged;
      signOut = fbAuth.signOut;

      GoogleAuthProvider = fbAuth.GoogleAuthProvider;
      signInWithPopup = fbAuth.signInWithPopup;
      updateProfile = fbAuth.updateProfile;

      getFirestore = fbDb.getFirestore;
      collection = fbDb.collection;
      getDocs = fbDb.getDocs;
      query = fbDb.query;
      where = fbDb.where;
      orderBy = fbDb.orderBy;
      addDoc = fbDb.addDoc;
      serverTimestamp = fbDb.serverTimestamp;
      doc = fbDb.doc;
      setDoc = fbDb.setDoc;
      getDoc = fbDb.getDoc;

      const app = initializeApp(firebaseConfig);
      auth = getAuth(app);
      db = getFirestore(app);
    }

    // ===== ELEMENTOS =====
    const authScreen = document.getElementById("authScreen");
    const appScreen = document.getElementById("appScreen");

    // Auth UI
    const tabLogin = document.getElementById("tabLogin");
    const tabRegister = document.getElementById("tabRegister");
    const authName = document.getElementById("authName");
    const authEmail = document.getElementById("authEmail");
    const authPass = document.getElementById("authPass");
    const btnAuthMain = document.getElementById("btnAuthMain");
    const btnGoogle = document.getElementById("btnGoogle");
    const btnEnterDemo = document.getElementById("btnEnterDemo");

    // Sidebar + mobile
    const sidebar = document.getElementById("sidebar");
    const overlay = document.getElementById("overlay");
    const btnOpenSidebar = document.getElementById("btnOpenSidebar");
    const btnCloseSidebar = document.getElementById("btnCloseSidebar");

    // Sidebar user
    const sbName = document.getElementById("sbName");
    const sbEmail = document.getElementById("sbEmail");

    // Stats
    const statOpen = document.getElementById("statOpen");
    const statOnline = document.getElementById("statOnline");
    const statApps = document.getElementById("statApps");

    // Pages
    const menuButtons = document.querySelectorAll(".menu-btn");
    const pages = document.querySelectorAll(".page");
    const pageTitle = document.getElementById("pageTitle");
    const pageSubtitle = document.getElementById("pageSubtitle");
    const btnRefresh = document.getElementById("btnRefresh");

    // Projects
    const projectsGrid = document.getElementById("projectsGrid");
    const projectsEmpty = document.getElementById("projectsEmpty");
    const searchInput = document.getElementById("searchInput");
    const categoryFilter = document.getElementById("categoryFilter");
    const levelFilter = document.getElementById("levelFilter");
    const typeFilter = document.getElementById("typeFilter");
    const btnApplyFilters = document.getElementById("btnApplyFilters");
    const btnClearFilters = document.getElementById("btnClearFilters");

    // Apps
    const appsList = document.getElementById("appsList");
    const appsEmpty = document.getElementById("appsEmpty");

    // Profile
    const profileName = document.getElementById("profileName");
    const profileRole = document.getElementById("profileRole");
    const profilePortfolio = document.getElementById("profilePortfolio");
    const profileSkills = document.getElementById("profileSkills");
    const profileBio = document.getElementById("profileBio");
    const btnSaveProfile = document.getElementById("btnSaveProfile");

    const previewName = document.getElementById("previewName");
    const previewRole = document.getElementById("previewRole");
    const previewChips = document.getElementById("previewChips");
    const previewBio = document.getElementById("previewBio");
    const previewPortfolio = document.getElementById("previewPortfolio");

    // Settings
    const btnToggleParticles = document.getElementById("btnToggleParticles");

    // Modal Projeto
    const projectModal = document.getElementById("projectModal");
    const closeProjectModal = document.getElementById("closeProjectModal");
    const modalStatus = document.getElementById("modalStatus");
    const modalCategory = document.getElementById("modalCategory");
    const modalType = document.getElementById("modalType");
    const modalLevel = document.getElementById("modalLevel");
    const modalTitle = document.getElementById("modalTitle");
    const modalShort = document.getElementById("modalShort");
    const modalBudget = document.getElementById("modalBudget");
    const modalDeadline = document.getElementById("modalDeadline");
    const modalDescription = document.getElementById("modalDescription");
    const modalSkills = document.getElementById("modalSkills");
    const applyPortfolio = document.getElementById("applyPortfolio");
    const applyMessage = document.getElementById("applyMessage");
    const btnApplyProject = document.getElementById("btnApplyProject");

    const btnLogout = document.getElementById("btnLogout");

    // ====== DEMO DATA ======
    const demoProjects = [
      {
        id: "demo-1",
        status: "open",
        title: "Landing Page Premium (Alta convers√£o)",
        short: "Cria√ß√£o de landing page com est√©tica premium, responsiva e r√°pida.",
        description: "Projeto para criar uma landing page com visual premium, anima√ß√µes suaves, copy organizada e foco total em convers√£o. Prefer√™ncia por estilo dark + neon.",
        category: "Web",
        type: "Remoto",
        level: "Intermedi√°rio",
        budgetMin: 900,
        budgetMax: 1600,
        deadline: "7 dias",
        skills: ["HTML", "Tailwind", "UX", "Copy", "Performance"]
      },
      {
        id: "demo-2",
        status: "open",
        title: "Identidade Visual (Branding + Manual)",
        short: "Marca completa com paleta, tipografia e guia de uso.",
        description: "Rebranding premium. Entrega: logo, varia√ß√µes, paleta, tipografia e manual curto.",
        category: "Branding",
        type: "Remoto",
        level: "Avan√ßado",
        budgetMin: 1200,
        budgetMax: 2500,
        deadline: "10 dias",
        skills: ["Illustrator", "Branding", "Grid", "Manual", "Apresenta√ß√£o"]
      },
      {
        id: "demo-3",
        status: "open",
        title: "Pacote Social Media (12 posts + 6 stories)",
        short: "Artes consistentes com est√©tica clean e moderna.",
        description: "Cria√ß√£o de kit social com consist√™ncia visual e varia√ß√µes mantendo padr√£o premium.",
        category: "Social Media",
        type: "Remoto",
        level: "Iniciante",
        budgetMin: 450,
        budgetMax: 900,
        deadline: "5 dias",
        skills: ["Design", "Tipografia", "Dire√ß√£o de Arte"]
      },
      {
        id: "demo-4",
        status: "closed",
        title: "Motion Reel (Intro + Lower Third)",
        short: "Motion clean e impactante, com neon sutil.",
        description: "Intro 4‚Äì6s + lower thirds. Dire√ß√£o futurista, neon controlado, sem exagero.",
        category: "Motion",
        type: "Remoto",
        level: "Intermedi√°rio",
        budgetMin: 700,
        budgetMax: 1400,
        deadline: "6 dias",
        skills: ["After Effects", "Motion", "Timing"]
      }
    ];

    // ====== STATE ======
    let currentUser = null;
    let allProjects = [];
    let currentProject = null;
    let authMode = "login"; // login | register

    // ====== HELPERS ======
    function showAuth(){
      authScreen.classList.remove("hidden");
      appScreen.classList.add("hidden");
    }
    function showApp(){
      authScreen.classList.add("hidden");
      appScreen.classList.remove("hidden");
    }

    function openSidebar(){
      sidebar.classList.add("open");
      overlay.classList.add("show");
    }
    function closeSidebar(){
      sidebar.classList.remove("open");
      overlay.classList.remove("show");
    }

    function openModal(el){ el.classList.add("open"); }
    function closeModal(el){ el.classList.remove("open"); }

    function formatBRL(min, max){
      if (!min && !max) return "A combinar";
      const fmt = (v) => Number(v).toLocaleString('pt-BR', { style:'currency', currency:'BRL' });
      if (min && max) return `${fmt(min)} ‚Äì ${fmt(max)}`;
      if (min) return `a partir de ${fmt(min)}`;
      return `at√© ${fmt(max)}`;
    }

    function projectCardHTML(p){
      const statusClass = p.status === "open" ? "badge-open" : "badge-closed";
      const statusText = p.status === "open" ? "ABERTO" : "ENCERRADO";
      const chips = (p.skills || []).slice(0, 4).map(s => `<span class="chip">${escapeHtml(s)}</span>`).join("");

      return `
        <article class="project-card">
          <div class="top-line"></div>
          <div class="p-5">
            <div class="flex items-center justify-between gap-3 flex-wrap">
              <span class="${statusClass}">${statusText}</span>
              <span class="chip">${escapeHtml(p.category || "Geral")}</span>
            </div>

            <h4 class="text-xl font-extrabold mt-3 text-gray-100">
              ${escapeHtml(p.title || "")}
            </h4>

            <p class="text-gray-300 text-sm mt-2 leading-relaxed">
              ${escapeHtml(p.short || "")}
            </p>

            <div class="mt-3 flex flex-wrap gap-2">
              <span class="chip">${escapeHtml(p.type || "Remoto")}</span>
              <span class="chip">${escapeHtml(p.level || "Intermedi√°rio")}</span>
              <span class="chip">${escapeHtml(p.deadline || "Prazo flex√≠vel")}</span>
            </div>

            <div class="mt-4 flex items-center justify-between gap-3">
              <div>
                <div class="text-xs text-gray-300 font-bold">Or√ßamento</div>
                <div class="text-sm font-extrabold gradient-text">${formatBRL(p.budgetMin, p.budgetMax)}</div>
              </div>

              <button class="btn btn-primary px-4 py-2 text-sm btnDetails" data-id="${escapeHtml(p.id)}">
                Ver detalhes
              </button>
            </div>

            <div class="mt-4 flex flex-wrap gap-2">
              ${chips || `<span class="chip">Asthro style</span>`}
            </div>
          </div>
        </article>
      `;
    }

    function renderProjects(list){
      projectsGrid.innerHTML = "";
      projectsEmpty.classList.add("hidden");

      if (!list.length){
        projectsEmpty.classList.remove("hidden");
        return;
      }

      list.forEach(p => projectsGrid.insertAdjacentHTML("beforeend", projectCardHTML(p)));

      document.querySelectorAll(".btnDetails").forEach(btn => {
        btn.addEventListener("click", () => {
          const id = btn.getAttribute("data-id");
          const p = allProjects.find(x => x.id === id);
          if (!p) return;
          openProject(p);
        });
      });
    }

    function openProject(p){
      currentProject = p;

      modalStatus.className = p.status === "open" ? "badge-open" : "badge-closed";
      modalStatus.textContent = p.status === "open" ? "ABERTO" : "ENCERRADO";

      modalCategory.textContent = p.category || "Geral";
      modalType.textContent = p.type || "Remoto";
      modalLevel.textContent = p.level || "Intermedi√°rio";
      modalTitle.textContent = p.title || "";
      modalShort.textContent = p.short || "";
      modalDescription.textContent = p.description || "";
      modalBudget.textContent = formatBRL(p.budgetMin, p.budgetMax);
      modalDeadline.textContent = p.deadline || "Prazo flex√≠vel";

      modalSkills.innerHTML = "";
      (p.skills || []).forEach(s => {
        modalSkills.insertAdjacentHTML("beforeend", `<span class="chip">${escapeHtml(s)}</span>`);
      });
      if (!(p.skills || []).length){
        modalSkills.insertAdjacentHTML("beforeend", `<span class="chip">Asthro standard</span>`);
      }

      openModal(projectModal);
    }

    function applyFilters(){
      const txt = (searchInput.value || "").toLowerCase().trim();
      const cat = categoryFilter.value;
      const lvl = levelFilter.value;
      const typ = typeFilter.value;

      const filtered = allProjects.filter(p => {
        const matchTxt = !txt || (
          (p.title || "").toLowerCase().includes(txt) ||
          (p.short || "").toLowerCase().includes(txt) ||
          (p.description || "").toLowerCase().includes(txt) ||
          (p.skills || []).join(" ").toLowerCase().includes(txt)
        );
        const matchCat = !cat || p.category === cat;
        const matchLvl = !lvl || p.level === lvl;
        const matchTyp = !typ || p.type === typ;

        return matchTxt && matchCat && matchLvl && matchTyp;
      });

      renderProjects(filtered);
      showToast("Filtros aplicados ‚úî");
    }

    function setPage(pageId){
      pages.forEach(p => p.classList.add("hidden"));
      document.getElementById(pageId).classList.remove("hidden");

      menuButtons.forEach(b => b.classList.remove("active"));
      document.querySelector(`.menu-btn[data-page="${pageId}"]`)?.classList.add("active");

      const titles = {
        pageProjects: ["Projetos", "Encontre vagas compat√≠veis com seu perfil e se inscreva."],
        pageApps: ["Minhas inscri√ß√µes", "Acompanhe seus envios com clareza."],
        pageProfile: ["Meu perfil", "Deixe seus dados profissionais completos."],
        pageSettings: ["Prefer√™ncias", "Deixe o portal confort√°vel para voc√™."]
      };

      const [t, s] = titles[pageId] || ["Portal", "Bem-vindo ao painel."];
      pageTitle.textContent = t;
      pageSubtitle.textContent = s;

      // Fecha sidebar no mobile ao trocar p√°gina
      closeSidebar();
    }

    function setAuthMode(mode){
      authMode = mode;

      if (mode === "login"){
        tabLogin.style.borderColor = "rgba(11,244,237,0.45)";
        tabLogin.style.color = "#0bf4ed";
        tabRegister.style.borderColor = "rgba(255,255,255,0.12)";
        tabRegister.style.color = "#edf1f7";
        authName.classList.add("hidden");
        btnAuthMain.textContent = "Entrar";
      } else {
        tabRegister.style.borderColor = "rgba(11,244,237,0.45)";
        tabRegister.style.color = "#0bf4ed";
        tabLogin.style.borderColor = "rgba(255,255,255,0.12)";
        tabLogin.style.color = "#edf1f7";
        authName.classList.remove("hidden");
        btnAuthMain.textContent = "Criar conta";
      }
    }

    function setPreview(){
      const nm = profileName.value.trim() || "Seu nome aqui";
      const rl = profileRole.value.trim() || "Sua √°rea aqui";
      const pf = profilePortfolio.value.trim();
      const sk = profileSkills.value.trim();
      const bio = profileBio.value.trim() || "Uma bio bem escrita te destaca. Mostre est√©tica, t√©cnica e entrega.";

      previewName.textContent = nm;
      previewRole.textContent = rl;
      previewBio.textContent = bio;

      previewChips.innerHTML = "";
      const skillsArr = sk ? sk.split(",").map(s => s.trim()).filter(Boolean) : [];
      skillsArr.slice(0, 6).forEach(s => previewChips.insertAdjacentHTML("beforeend", `<span class="chip">${escapeHtml(s)}</span>`));
      if (!skillsArr.length){
        previewChips.insertAdjacentHTML("beforeend", `<span class="chip">skills</span>`);
        previewChips.insertAdjacentHTML("beforeend", `<span class="chip">Asthro standard</span>`);
      }

      if (pf){
        previewPortfolio.href = pf;
        previewPortfolio.classList.remove("hidden");
      } else {
        previewPortfolio.classList.add("hidden");
      }
    }

    async function updateStats(){
      try{
        const openCount = allProjects.filter(p => p.status === "open").length;
        statOpen.textContent = String(openCount);
        statOnline.textContent = String(Math.max(8, openCount * 3 + 11));

        if (!isFirebaseReady){
          statApps.textContent = "--";
          return;
        }
        const snap = await getDocs(collection(db, "applications"));
        statApps.textContent = String(snap.size);
      } catch {
        statApps.textContent = "--";
      }
    }

    async function loadProjects(){
      // Skeleton simples
      projectsGrid.innerHTML = "";
      projectsEmpty.classList.add("hidden");

      const placeholders = Array.from({length:6}).map(() => `
        <div class="glass p-5 animate-pulse">
          <div class="h-4 w-24 bg-white/10 rounded mb-3"></div>
          <div class="h-6 w-3/4 bg-white/10 rounded mb-2"></div>
          <div class="h-4 w-full bg-white/10 rounded mb-2"></div>
          <div class="h-4 w-2/3 bg-white/10 rounded mb-4"></div>
          <div class="h-10 w-36 bg-white/10 rounded-full"></div>
        </div>
      `).join("");
      projectsGrid.innerHTML = placeholders;

      if (!isFirebaseReady){
        allProjects = demoProjects;
        renderProjects(allProjects);
        await updateStats();
        return;
      }

      try{
        const q = query(collection(db, "projects"), orderBy("createdAt","desc"));
        const snap = await getDocs(q);

        const items = [];
        snap.forEach(d => items.push({ id: d.id, ...d.data() }));

        allProjects = items.map(p => ({
          ...p,
          status: p.status || "open",
          skills: Array.isArray(p.skills) ? p.skills : [],
          budgetMin: Number(p.budgetMin || 0) || null,
          budgetMax: Number(p.budgetMax || 0) || null
        }));

        renderProjects(allProjects);
        await updateStats();
      } catch (err){
        console.error(err);
        allProjects = demoProjects;
        renderProjects(allProjects);
        showToast("Erro no Firestore. Mostrando DEMO.");
        await updateStats();
      }
    }

    async function loadMyApplications(){
      appsList.innerHTML = "";
      appsEmpty.classList.add("hidden");

      if (!currentUser){
        appsEmpty.classList.remove("hidden");
        appsEmpty.textContent = "Fa√ßa login para ver suas inscri√ß√µes.";
        return;
      }

      if (!isFirebaseReady){
        appsEmpty.classList.remove("hidden");
        appsEmpty.textContent = "No modo DEMO, inscri√ß√µes n√£o ficam salvas.";
        return;
      }

      try{
        const q = query(
          collection(db, "applications"),
          where("userId","==",currentUser.uid),
          orderBy("createdAt","desc")
        );
        const snap = await getDocs(q);

        const items = [];
        snap.forEach(d => items.push({ id:d.id, ...d.data() }));

        if (!items.length){
          appsEmpty.classList.remove("hidden");
          return;
        }

        items.forEach(a => {
          appsList.insertAdjacentHTML("beforeend", `
            <div class="glass p-4">
              <div class="flex items-start justify-between gap-3">
                <div>
                  <div class="text-sm text-gray-300 font-bold">Projeto</div>
                  <div class="text-xl font-extrabold gradient-text mt-1">${escapeHtml(a.projectTitle || "Projeto")}</div>
                  <div class="text-xs text-gray-400 mt-1">Status: ${escapeHtml(a.status || "sent")}</div>
                </div>
                <span class="chip">Inscrito</span>
              </div>
              ${a.message ? `<div class="text-sm text-gray-300 mt-2">Mensagem: ${escapeHtml(a.message)}</div>` : ""}
              ${a.portfolio ? `<div class="text-sm text-gray-300 mt-2">Portf√≥lio: <a class="gradient-text font-extrabold" href="${escapeHtml(a.portfolio)}" target="_blank">abrir</a></div>` : ""}
            </div>
          `);
        });
      } catch (err){
        console.error(err);
        appsEmpty.classList.remove("hidden");
        appsEmpty.textContent = "Erro ao carregar inscri√ß√µes (verifique regras).";
      }
    }

    async function loadProfile(){
      if (!currentUser) return;

      if (!isFirebaseReady){
        profileName.value = currentUser.displayName || "";
        setPreview();
        return;
      }

      try{
        const ref = doc(db, "freelancers", currentUser.uid);
        const snap = await getDoc(ref);

        if (snap.exists()){
          const d = snap.data();
          profileName.value = d.name || currentUser.displayName || "";
          profileRole.value = d.role || "";
          profilePortfolio.value = d.portfolio || "";
          profileSkills.value = d.skills || "";
          profileBio.value = d.bio || "";
        } else {
          profileName.value = currentUser.displayName || "";
        }

        setPreview();
      } catch (err){
        console.error(err);
      }
    }

    async function saveProfile(){
      if (!currentUser){
        showToast("Fa√ßa login para salvar seu perfil.");
        return;
      }

      const data = {
        name: profileName.value.trim(),
        role: profileRole.value.trim(),
        portfolio: profilePortfolio.value.trim(),
        skills: profileSkills.value.trim(),
        bio: profileBio.value.trim(),
        updatedAt: isFirebaseReady ? serverTimestamp() : new Date().toISOString(),
      };

      if (!isFirebaseReady){
        showToast("Perfil salvo (DEMO) ‚úî");
        return;
      }

      try{
        await setDoc(doc(db, "freelancers", currentUser.uid), {
          uid: currentUser.uid,
          email: currentUser.email || "",
          displayName: currentUser.displayName || "",
          ...data
        }, { merge:true });

        showToast("Perfil salvo com sucesso ‚úî");
      } catch (err){
        console.error(err);
        showToast("Erro ao salvar perfil. Verifique regras do Firebase.");
      }
    }

    async function applyProject(){
      if (!currentUser){
        showToast("Voc√™ precisa estar logado.");
        return;
      }
      if (!currentProject) return;

      if (currentProject.status !== "open"){
        showToast("Este projeto est√° encerrado.");
        return;
      }

      const msg = (applyMessage.value || "").trim();
      const pf = (applyPortfolio.value || "").trim();

      if (!msg){
        showToast("Escreva uma mensagem curta antes de enviar.");
        return;
      }

      if (!isFirebaseReady){
        showToast("Inscri√ß√£o enviada (DEMO) ‚úî");
        applyMessage.value = "";
        applyPortfolio.value = "";
        closeModal(projectModal);
        return;
      }

      try{
        await addDoc(collection(db, "applications"), {
          userId: currentUser.uid,
          userEmail: currentUser.email || "",
          userName: currentUser.displayName || "",
          projectId: currentProject.id,
          projectTitle: currentProject.title || "",
          portfolio: pf || "",
          message: msg || "",
          createdAt: serverTimestamp(),
          status: "sent"
        });

        showToast("Inscri√ß√£o enviada ‚úî");
        applyMessage.value = "";
        applyPortfolio.value = "";
        closeModal(projectModal);

        await loadMyApplications();
        await updateStats();
      } catch (err){
        console.error(err);
        showToast("Erro ao enviar inscri√ß√£o. Verifique regras do Firebase.");
      }
    }

    function setUserState(user){
      currentUser = user;

      if (!user){
        showAuth();
        return;
      }

      sbName.textContent = user.displayName || "Freelancer Asthro";
      sbEmail.textContent = user.email || "--";

      showApp();
      setPage("pageProjects");
    }

    // ====== AUTH ACTIONS ======
    async function authMain(){
      const email = authEmail.value.trim();
      const pass = authPass.value.trim();
      const name = authName.value.trim();

      if (!email || !pass){
        showToast("Preencha e-mail e senha.");
        return;
      }

      // DEMO
      if (!isFirebaseReady){
        setUserState({ uid:"demo", email, displayName: name || "Freelancer DEMO" });
        showToast("Logado (DEMO) ‚úî");
        await loadProjects();
        await loadMyApplications();
        await loadProfile();
        return;
      }

      try{
        if (authMode === "login"){
          const cred = await signInWithEmailAndPassword(auth, email, pass);
          setUserState(cred.user);
          showToast("Login realizado ‚úî");
        } else {
          const cred = await createUserWithEmailAndPassword(auth, email, pass);
          if (name){
            await updateProfile(cred.user, { displayName:name });
          }
          setUserState(auth.currentUser);
          showToast("Conta criada ‚úî");
        }

        authEmail.value = "";
        authPass.value = "";
        authName.value = "";

        await loadProjects();
        await loadMyApplications();
        await loadProfile();
      } catch (err){
        console.error(err);

        // Mensagens mais humanas
        const code = String(err?.code || "");
        if (code.includes("auth/invalid-email")) return showToast("E-mail inv√°lido.");
        if (code.includes("auth/email-already-in-use")) return showToast("Esse e-mail j√° est√° cadastrado.");
        if (code.includes("auth/wrong-password")) return showToast("Senha incorreta.");
        if (code.includes("auth/weak-password")) return showToast("Senha fraca. Use pelo menos 6 caracteres.");
        if (code.includes("auth/user-not-found")) return showToast("Conta n√£o encontrada.");
        return showToast("Erro ao autenticar. Verifique Firebase.");
      }
    }

    async function authGoogle(){
      if (!isFirebaseReady){
        setUserState({ uid:"demo", email:"demo@asthro.com", displayName:"Freelancer Google (DEMO)" });
        showToast("Logado (DEMO) ‚úî");
        await loadProjects();
        await loadMyApplications();
        await loadProfile();
        return;
      }

      try{
        const provider = new GoogleAuthProvider();
        const cred = await signInWithPopup(auth, provider);
        setUserState(cred.user);
        showToast("Login Google ‚úî");
        await loadProjects();
        await loadMyApplications();
        await loadProfile();
      } catch (err){
        console.error(err);
        showToast("Erro no login Google.");
      }
    }

    async function doLogout(){
      if (!currentUser) return;

      if (!isFirebaseReady){
        setUserState(null);
        showToast("Saiu (DEMO).");
        return;
      }

      try{
        await signOut(auth);
        setUserState(null);
        showToast("Voc√™ saiu.");
      } catch (err){
        console.error(err);
      }
    }

    // ====== EVENTS ======
    tabLogin.addEventListener("click", () => setAuthMode("login"));
    tabRegister.addEventListener("click", () => setAuthMode("register"));
    btnAuthMain.addEventListener("click", authMain);
    btnGoogle.addEventListener("click", authGoogle);

    btnEnterDemo.addEventListener("click", async () => {
      setUserState({ uid:"demo", email:"demo@asthro.com", displayName:"Freelancer DEMO" });
      showToast("Entrou no modo DEMO ‚úî");
      await loadProjects();
      await loadMyApplications();
      await loadProfile();
    });

    btnOpenSidebar.addEventListener("click", openSidebar);
    btnCloseSidebar.addEventListener("click", closeSidebar);
    overlay.addEventListener("click", closeSidebar);

    menuButtons.forEach(btn => {
      btn.addEventListener("click", () => setPage(btn.getAttribute("data-page")));
    });

    btnRefresh.addEventListener("click", async () => {
      await loadProjects();
      if (currentUser) await loadMyApplications();
      showToast("Atualizado ‚úî");
    });

    btnApplyFilters.addEventListener("click", applyFilters);
    btnClearFilters.addEventListener("click", () => {
      searchInput.value = "";
      categoryFilter.value = "";
      levelFilter.value = "";
      typeFilter.value = "";
      renderProjects(allProjects);
      showToast("Filtros limpos ‚úî");
    });

    closeProjectModal.addEventListener("click", () => closeModal(projectModal));
    projectModal.addEventListener("click", (e) => { if (e.target === projectModal) closeModal(projectModal); });

    btnApplyProject.addEventListener("click", applyProject);
    btnSaveProfile.addEventListener("click", saveProfile);
    btnLogout.addEventListener("click", doLogout);

    [profileName, profileRole, profilePortfolio, profileSkills, profileBio].forEach(el => {
      el.addEventListener("input", setPreview);
    });

    // Prefer√™ncias: part√≠culas
    btnToggleParticles.addEventListener("click", () => {
      particlesEnabled = !particlesEnabled;
      const el = document.getElementById("particles-js");
      el.style.display = particlesEnabled ? "block" : "none";
      btnToggleParticles.textContent = particlesEnabled ? "Desativar part√≠culas" : "Ativar part√≠culas";
      showToast(particlesEnabled ? "Part√≠culas ativadas ‚úî" : "Part√≠culas desativadas ‚úî");
    });

    // ===== INIT =====
    setAuthMode("login");
    showAuth();
    setPreview();

    // Observa auth real
    if (isFirebaseReady){
      onAuthStateChanged(auth, async (user) => {
        setUserState(user);
        await loadProjects();
        if (user){
          await loadMyApplications();
          await loadProfile();
        }
        await updateStats();
      });
    } else {
      // Sem firebase: mostra stats e lista demo na tela de login
      allProjects = demoProjects;
      await updateStats();
    }

    // Sempre carrega lista na tela (para stats bonitos e o dashboard pronto)
    await loadProjects();
    await updateStats();
  </script>
</body>
</html>
